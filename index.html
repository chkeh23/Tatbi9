<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üëΩ Alien Musk Quantum Mining Platform v6.0</title>
    
    <!-- Telegram WebApp SDK -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- SIMPLIFIED CSS - ÿ®ÿØŸàŸÜ ŸÖÿ™ÿ∫Ÿäÿ±ÿßÿ™ ŸÖÿπŸÇÿØÿ© -->
    <style>
        /* RESET & BASE */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: #0a0a0f;
            color: white;
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        /* LOADING SCREEN */
        #loading-screen {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: #050510;
            z-index: 9999;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .loading-container {
            text-align: center;
            padding: 20px;
        }
        
        .alien-logo {
            font-size: 60px;
            margin-bottom: 20px;
            color: #00ff88;
            animation: float 3s ease-in-out infinite;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        
        .loading-title {
            font-size: 24px;
            font-weight: bold;
            background: linear-gradient(45deg, #00ff88, #00d4ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }
        
        .loading-progress {
            margin-top: 30px;
        }
        
        .progress-bar {
            width: 200px;
            height: 6px;
            background: rgba(255,255,255,0.1);
            border-radius: 3px;
            overflow: hidden;
            margin: 10px auto;
        }
        
        #loading-progress-bar {
            height: 100%;
            width: 25%;
            background: linear-gradient(90deg, #00ff88, #00d4ff);
            border-radius: 3px;
        }
        
        /* APP CONTAINER */
        #app-container.hidden {
            display: none;
        }
        
        /* HEADER */
        .app-header {
            background: rgba(26, 26, 46, 0.95);
            padding: 10px 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid rgba(0, 255, 136, 0.3);
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 8px;
            color: #00ff88;
            font-weight: bold;
        }
        
        .user-info-mini {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .user-avatar-mini {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            border: 2px solid #00ff88;
        }
        
        .total-balance-header {
            text-align: right;
        }
        
        /* NAVIGATION */
        .main-nav {
            display: flex;
            background: #1a1a2e;
            margin: 10px;
            border-radius: 12px;
            padding: 4px;
        }
        
        .nav-btn {
            flex: 1;
            padding: 12px 5px;
            background: transparent;
            border: none;
            color: #b0b0d0;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            border-radius: 8px;
            cursor: pointer;
        }
        
        .nav-btn.active {
            background: linear-gradient(135deg, #00ff88, #00d4ff);
            color: white;
        }
        
        /* PAGES */
        .page {
            display: none;
            padding: 15px;
        }
        
        .page.active {
            display: block;
        }
        
        /* MINING SECTION */
        .mining-section {
            background: #1a1a2e;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
            border: 1px solid rgba(0, 255, 136, 0.2);
        }
        
        .mining-timer-card {
            background: rgba(0,0,0,0.3);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            margin: 15px 0;
            border: 1px solid rgba(0,255,136,0.1);
        }
        
        .mining-action-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #00ff88, #00d4ff);
            border: none;
            border-radius: 8px;
            color: white;
            font-weight: bold;
            font-size: 16px;
            margin: 15px 0;
            cursor: pointer;
        }
        
        /* BUTTONS */
        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        /* MODALS */
        .modal-overlay {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.8);
            z-index: 1000;
            display: none;
        }
        
        .modal-overlay.active {
            display: block;
        }
        
        .modal {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: #1a1a2e;
            border-radius: 12px;
            padding: 20px;
            width: 90%;
            max-width: 400px;
            max-height: 80vh;
            overflow-y: auto;
            border: 1px solid rgba(0,255,136,0.3);
        }
        
        /* NOTIFICATIONS */
        #notification-container {
            position: fixed;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 2000;
            width: 90%;
            max-width: 400px;
        }
        
        .message {
            padding: 12px 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
            backdrop-filter: blur(10px);
        }
        
        .message.success {
            background: rgba(0,255,136,0.15);
            border: 1px solid rgba(0,255,136,0.3);
            color: #00ff88;
        }
        
        .message.error {
            background: rgba(255,68,68,0.15);
            border: 1px solid rgba(255,68,68,0.3);
            color: #ff4444;
        }
        
        /* RESPONSIVE */
        @media (max-width: 480px) {
            .app-header {
                padding: 8px 10px;
            }
            
            .page {
                padding: 10px;
            }
            
            .mining-section {
                padding: 15px;
            }
        }
    </style>
</head>
<body>
    <!-- Loading Screen -->
    <div id="loading-screen" class="active">
        <div class="loading-container">
            <div class="alien-logo">üëΩ</div>
            <h1 class="loading-title">Alien Musk Quantum</h1>
            <p class="loading-subtitle">Initializing Quantum Systems...</p>
            <div class="loading-progress">
                <div class="progress-bar">
                    <div id="loading-progress-bar" class="progress-fill"></div>
                </div>
                <span id="loading-progress-text" class="progress-text">Loading... 25%</span>
            </div>
        </div>
    </div>

    <!-- App Container -->
    <div id="app-container" class="hidden">
        <!-- Header -->
        <header class="app-header">
            <div class="header-left">
                <div class="logo" id="admin-logo">
                    <i class="fas fa-robot"></i>
                    <span>Alien Musk</span>
                </div>
                
                <div class="user-info-mini">
                    <img id="user-avatar-mini" class="user-avatar-mini" 
                         src="https://api.dicebear.com/7.x/avataaars/svg?seed=alien" 
                         alt="Avatar">
                    <div class="user-details-mini">
                        <div id="username-mini" class="username-mini">Alien</div>
                        <div id="user-id-mini" class="user-id-mini">ID: Loading...</div>
                    </div>
                </div>
            </div>
            
            <div class="header-right">
                <div class="total-balance-header">
                    <div class="balance-amount-header">
                        <i class="fas fa-coins"></i>
                        <span id="total-balance-amsk">0</span>
                        <span class="currency">AMSK</span>
                    </div>
                    <div class="balance-usd-header">
                        ‚âà $<span id="total-balance-usd">0.00</span>
                    </div>
                </div>
            </div>
        </header>

        <!-- Navigation -->
        <nav class="main-nav">
            <button class="nav-btn active" data-page="home" onclick="switchPage('home')">
                <i class="fas fa-home"></i>
                <span>Home</span>
            </button>
            <button class="nav-btn" data-page="staking" onclick="switchPage('staking')">
                <i class="fas fa-gem"></i>
                <span>Staking</span>
            </button>
            <button class="nav-btn" data-page="wallet" onclick="switchPage('wallet')">
                <i class="fas fa-wallet"></i>
                <span>Wallet</span>
            </button>
            <button class="nav-btn" data-page="referral" onclick="switchPage('referral')">
                <i class="fas fa-users"></i>
                <span>Referral</span>
            </button>
        </nav>

        <!-- Notification Container -->
        <div id="notification-container"></div>

        <!-- Home Page -->
        <div id="home-page" class="page active">
            <section class="mining-section">
                <div class="mining-header">
                    <h3><i class="fas fa-microchip"></i> Quantum Mining</h3>
                    <div class="mining-stats">
                        <div class="stat-item">
                            <div class="stat-label">Level</div>
                            <div class="stat-value" id="current-mining-level">1</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label">Hashrate</div>
                            <div class="stat-value" id="current-hashrate-display">2,500</div>
                        </div>
                    </div>
                </div>

                <div class="mining-timer-card">
                    <div class="timer-display">
                        <i class="fas fa-clock"></i>
                        <span id="mining-timer-display">01:00:00</span>
                    </div>
                    <div class="next-reward">
                        Next Reward: <span id="next-reward-amount">2,500</span> AMSK
                    </div>
                </div>

                <button class="mining-action-btn" id="start-mining-btn" onclick="handleMiningAction()">
                    <i class="fas fa-play"></i>
                    <span>Start Quantum Mining</span>
                </button>

                <div class="mining-info">
                    <div class="info-item">
                        <i class="fas fa-chart-line"></i>
                        <span>Total Mined: <span id="total-mined">2,500</span> AMSK</span>
                    </div>
                    <div class="info-item">
                        <i class="fas fa-calendar-day"></i>
                        <span>Today: <span id="mined-today">2,500</span> AMSK</span>
                    </div>
                </div>
            </section>
        </div>

        <!-- Staking Page -->
        <div id="staking-page" class="page">
            <div class="staking-content">
                <div class="staking-card">
                    <h4><i class="fas fa-gem"></i> Quantum Staking</h4>
                    <p>Stake USDT to earn AMSK tokens</p>
                    
                    <div class="total-staked-card">
                        <div>
                            <div class="staked-label">Total Staked</div>
                            <div class="staked-amount" id="total-staked">0 USDT</div>
                        </div>
                    </div>
                    
                    <!-- Simple staking buttons -->
                    <div style="margin-top: 20px;">
                        <button class="stake-plan-btn" onclick="openStakeModal(1)" 
                                style="width: 100%; padding: 12px; margin: 5px 0; background: linear-gradient(135deg, #9d4edd, #ff0080); color: white; border: none; border-radius: 8px;">
                            Silver Plan - 40% APR
                        </button>
                        <button class="stake-plan-btn" onclick="openStakeModal(2)"
                                style="width: 100%; padding: 12px; margin: 5px 0; background: linear-gradient(135deg, #00ff88, #00d4ff); color: white; border: none; border-radius: 8px;">
                            Gold Plan - 50% APR
                        </button>
                        <button class="stake-plan-btn" onclick="openStakeModal(3)"
                                style="width: 100%; padding: 12px; margin: 5px 0; background: linear-gradient(135deg, #ffd700, #ff9900); color: white; border: none; border-radius: 8px;">
                            Diamond Plan - 60% APR
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Wallet Page -->
        <div id="wallet-page" class="page">
            <div class="wallet-content">
                <div class="wallet-balance-card">
                    <h4><i class="fas fa-wallet"></i> Total Balance</h4>
                    <div class="wallet-balance-amount" id="wallet-balance-amsk">0</div>
                    <div class="wallet-balance-subtitle">AMSK Tokens</div>
                    <div class="wallet-balance-usd" id="wallet-balance-usd">$0.00</div>
                </div>

                <div style="margin-top: 20px;">
                    <div style="display: flex; gap: 10px; margin-bottom: 15px;">
                        <button class="wallet-action-btn" onclick="openDepositModal('USDT')"
                                style="flex: 1; padding: 15px; background: rgba(0,212,255,0.1); border: 1px solid rgba(0,212,255,0.3); border-radius: 8px; color: white;">
                            <i class="fas fa-download"></i> Deposit
                        </button>
                        <button class="wallet-action-btn" onclick="openWithdrawModal()"
                                style="flex: 1; padding: 15px; background: rgba(0,255,136,0.1); border: 1px solid rgba(0,255,136,0.3); border-radius: 8px; color: white;">
                            <i class="fas fa-upload"></i> Withdraw
                        </button>
                    </div>
                    
                    <div style="display: flex; gap: 10px;">
                        <button class="wallet-action-btn" onclick="openSwapModal()"
                                style="flex: 1; padding: 15px; background: rgba(157,78,221,0.1); border: 1px solid rgba(157,78,221,0.3); border-radius: 8px; color: white;">
                            <i class="fas fa-exchange-alt"></i> Swap
                        </button>
                        <button class="wallet-action-btn" onclick="showTransactionHistory()"
                                style="flex: 1; padding: 15px; background: rgba(255,215,0,0.1); border: 1px solid rgba(255,215,0,0.3); border-radius: 8px; color: white;">
                            <i class="fas fa-history"></i> History
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Referral Page -->
        <div id="referral-page" class="page">
            <div class="referral-content">
                <div class="referral-stats-card">
                    <h4><i class="fas fa-chart-line"></i> Referral Stats</h4>
                    <div style="display: flex; gap: 20px; margin-top: 15px;">
                        <div>
                            <div class="ref-stat-value" id="ref-count">0</div>
                            <div class="ref-stat-label">Referrals</div>
                        </div>
                        <div>
                            <div class="ref-stat-value" id="ref-earned">0</div>
                            <div class="ref-stat-label">AMSK Earned</div>
                        </div>
                    </div>
                </div>

                <div class="referral-code-card" style="margin-top: 15px; padding: 15px; background: #1a1a2e; border-radius: 12px;">
                    <h4><i class="fas fa-user-friends"></i> Your Referral Code</h4>
                    <div class="referral-code-display" id="referral-code-display" 
                         style="padding: 15px; background: rgba(255,0,128,0.1); border-radius: 8px; margin: 10px 0; font-family: monospace; color: #ff0080;">
                        ALIEN-XXXXXX
                    </div>
                    <button onclick="copyToClipboard(document.getElementById('referral-code-display').textContent)"
                            style="width: 100%; padding: 12px; background: linear-gradient(135deg, #9d4edd, #ff0080); color: white; border: none; border-radius: 8px;">
                        <i class="far fa-copy"></i> Copy Code
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- FIXED CONNECTOR SCRIPT -->
    <script>
        console.log("üëΩ Alien Musk Quantum Platform - Starting...");
        
        // Global variables
        window.tg = null;
        window.db = null;
        window.firebaseApp = null;
        window.userData = null;
        window.walletData = null;
        
        // Firebase config
        const firebaseConfig = {
            apiKey: "AIzaSyCklv_zMfndK4-xUHECyD5XA7p_-20e1t8",
            authDomain: "tatbi9-681bf.firebaseapp.com",
            projectId: "tatbi9-681bf",
            storageBucket: "tatbi9-681bf.firebasestorage.app",
            messagingSenderId: "863237064748",
            appId: "1:863237064748:web:134de1e01d2639ef5fa989"
        };
        
        // Initialize Firebase
        function initFirebase() {
            if (typeof firebase !== 'undefined') {
                try {
                    window.firebaseApp = firebase.initializeApp(firebaseConfig);
                    window.db = firebase.firestore();
                    console.log("‚úÖ Firebase initialized");
                } catch (error) {
                    console.log("‚ö†Ô∏è Firebase error:", error);
                }
            }
        }
        
        // Initialize Telegram
        function initTelegram() {
            try {
                if (window.Telegram && window.Telegram.WebApp) {
                    window.tg = Telegram.WebApp;
                    window.tg.ready();
                    window.tg.expand();
                    console.log("‚úÖ Telegram WebApp initialized");
                }
            } catch (e) {
                console.log("‚ö†Ô∏è Not in Telegram");
            }
        }
        
        // Basic functions for HTML
        window.switchPage = function(page) {
            const pages = document.querySelectorAll('.page');
            const navBtns = document.querySelectorAll('.nav-btn');
            
            pages.forEach(p => p.classList.remove('active'));
            navBtns.forEach(btn => btn.classList.remove('active'));
            
            document.getElementById(page + '-page').classList.add('active');
            document.querySelector(`.nav-btn[data-page="${page}"]`).classList.add('active');
        };
        
        window.showMessage = function(text, type = 'info') {
            const container = document.getElementById('notification-container');
            if (!container) return;
            
            const msg = document.createElement('div');
            msg.className = `message ${type}`;
            msg.innerHTML = `<i class="fas fa-${type === 'success' ? 'check-circle' : 'info-circle'}"></i> ${text}`;
            container.appendChild(msg);
            
            setTimeout(() => msg.remove(), 4000);
        };
        
        window.closeModal = function() {
            document.querySelectorAll('.modal-overlay').forEach(el => el.remove());
        };
        
        window.copyToClipboard = function(text) {
            navigator.clipboard.writeText(text)
                .then(() => showMessage('Copied!', 'success'))
                .catch(() => showMessage('Failed to copy', 'error'));
        };
        
        // Initialize everything
        document.addEventListener('DOMContentLoaded', function() {
            console.log("üì± DOM loaded");
            
            initFirebase();
            initTelegram();
            
            // Hide loading after 2 seconds
            setTimeout(() => {
                document.getElementById('loading-screen').style.display = 'none';
                document.getElementById('app-container').classList.remove('hidden');
                
                // Start main app if available
                if (typeof initAlienMuskApp === 'function') {
                    initAlienMuskApp();
                } else {
                    console.error("‚ùå Main app not found!");
                    showMessage("Loading main application...", "warning");
                    
                    // Try to load app.js dynamically
                    const script = document.createElement('script');
                    script.src = 'app.js';
                    script.onload = function() {
                        if (typeof initAlienMuskApp === 'function') {
                            initAlienMuskApp();
                        }
                    };
                    document.head.appendChild(script);
                }
            }, 2000);
        });
    </script>
    
    <!-- Main Application JS -->
    <script src="app.js"></script>
</body>
</html>
