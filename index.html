<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ðŸ‘½ Alien Musk - Quantum Mining Platform v6.0</title>
    
    <!-- Telegram WebApp SDK -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- CSS Styles -->
    <style>
        /* ============================================ */
        /* ALIEN MUSK - QUANTUM MINING PLATFORM v6.0 */
        /* VIP PROFESSIONAL SPACE THEME */
        /* ============================================ */
        
        :root {
            /* Space Colors */
            --space-black: #0a0a0f;
            --space-dark: #121225;
            --space-blue: #1a1a3a;
            --space-purple: #2a1a4a;
            --neon-green: #00ff9d;
            --neon-blue: #00d9ff;
            --neon-purple: #9d4edd;
            --neon-pink: #ff00aa;
            --alien-glow: #00ff88;
            --star-white: #ffffff;
            --star-light: #e0e0ff;
            --nebula-purple: #6a00ff;
            --quantum-cyan: #00ffff;
            
            /* Gradients */
            --gradient-space: linear-gradient(135deg, var(--space-black), var(--space-purple));
            --gradient-neon: linear-gradient(135deg, var(--neon-green), var(--neon-blue));
            --gradient-alien: linear-gradient(135deg, var(--alien-glow), var(--quantum-cyan));
            --gradient-card: linear-gradient(145deg, rgba(26, 26, 58, 0.9), rgba(42, 26, 74, 0.9));
            --gradient-header: linear-gradient(135deg, rgba(10, 10, 15, 0.95), rgba(26, 26, 58, 0.95));
            
            /* Shadows */
            --shadow-neon: 0 0 20px rgba(0, 255, 157, 0.5);
            --shadow-purple: 0 0 20px rgba(157, 78, 221, 0.5);
            --shadow-blue: 0 0 20px rgba(0, 217, 255, 0.5);
            --shadow-card: 0 10px 30px rgba(0, 0, 0, 0.5);
            --shadow-nav: 0 -5px 25px rgba(0, 0, 0, 0.7);
            
            /* Borders */
            --border-neon: 1px solid rgba(0, 255, 157, 0.3);
            --border-purple: 1px solid rgba(157, 78, 221, 0.3);
            --border-blue: 1px solid rgba(0, 217, 255, 0.3);
            --border-space: 1px solid rgba(255, 255, 255, 0.1);
            
            /* Radius */
            --radius-sm: 8px;
            --radius-md: 12px;
            --radius-lg: 20px;
            --radius-xl: 30px;
            
            /* Spacing */
            --space-xs: 8px;
            --space-sm: 12px;
            --space-md: 16px;
            --space-lg: 24px;
            --space-xl: 32px;
        }
        
        /* Reset & Base */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        html, body {
            width: 100%;
            height: 100%;
            overflow-x: hidden;
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
            background: var(--space-black);
            color: var(--star-white);
            direction: rtl;
            line-height: 1.6;
            -webkit-font-smoothing: antialiased;
            scroll-behavior: smooth;
        }
        
        /* Background Space Effect */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 30%, rgba(106, 0, 255, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(0, 255, 157, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 40% 80%, rgba(0, 217, 255, 0.1) 0%, transparent 50%);
            z-index: -2;
            pointer-events: none;
        }
        
        /* Star Field Animation */
        @keyframes twinkle {
            0%, 100% { opacity: 0.2; }
            50% { opacity: 1; }
        }
        
        .star {
            position: fixed;
            background: white;
            border-radius: 50%;
            animation: twinkle 3s infinite;
            z-index: -1;
        }
        
        /* Loading Screen - Space Theme */
        #loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--space-black);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 0.5s ease;
        }
        
        .loading-container {
            text-align: center;
            padding: var(--space-xl);
            max-width: 320px;
            width: 90%;
        }
        
        .alien-logo {
            font-size: 60px;
            margin-bottom: var(--space-lg);
            animation: float 3s ease-in-out infinite;
            text-shadow: 0 0 20px var(--alien-glow);
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            33% { transform: translateY(-10px) rotate(5deg); }
            66% { transform: translateY(5px) rotate(-5deg); }
        }
        
        .loading-title {
            font-size: 32px;
            font-weight: 800;
            background: linear-gradient(45deg, var(--neon-green), var(--neon-blue), var(--neon-purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: var(--space-sm);
            letter-spacing: 2px;
        }
        
        .loading-subtitle {
            font-size: 14px;
            color: var(--star-light);
            margin-bottom: var(--space-xl);
            font-weight: 300;
            opacity: 0.8;
        }
        
        .loading-progress {
            margin-top: var(--space-xl);
        }
        
        .progress-bar {
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: var(--radius-sm);
            overflow: hidden;
            margin-bottom: var(--space-sm);
            border: var(--border-space);
        }
        
        #loading-progress-bar {
            height: 100%;
            width: 25%;
            background: var(--gradient-neon);
            border-radius: var(--radius-sm);
            transition: width 0.3s ease;
            box-shadow: var(--shadow-neon);
        }
        
        #loading-progress-text {
            font-size: 12px;
            color: var(--star-light);
            font-family: 'Courier New', monospace;
            letter-spacing: 1px;
        }
        
        /* VIP Space Header */
        .app-header {
            background: var(--gradient-header);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-bottom: var(--border-space);
            padding: var(--space-sm) var(--space-md);
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: 70px;
            box-shadow: 0 5px 30px rgba(0, 0, 0, 0.5);
        }
        
        .header-left {
            display: flex;
            align-items: center;
            gap: var(--space-md);
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            padding: 10px 16px;
            background: rgba(0, 255, 157, 0.1);
            border-radius: var(--radius-lg);
            border: var(--border-neon);
            position: relative;
            overflow: hidden;
        }
        
        .logo::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(0, 255, 157, 0.1), transparent);
            animation: shine 3s infinite linear;
            transform: rotate(45deg);
        }
        
        @keyframes shine {
            0% { transform: translateX(-100%) rotate(45deg); }
            100% { transform: translateX(100%) rotate(45deg); }
        }
        
        .logo i {
            font-size: 22px;
            color: var(--neon-green);
            z-index: 1;
        }
        
        .logo span {
            font-size: 18px;
            font-weight: 800;
            background: var(--gradient-neon);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            z-index: 1;
        }
        
        .user-info-mini {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            padding: 8px 12px;
            background: rgba(157, 78, 221, 0.1);
            border-radius: var(--radius-md);
            border: var(--border-purple);
        }
        
        .user-avatar-mini {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid var(--neon-purple);
            box-shadow: var(--shadow-purple);
        }
        
        .user-details-mini {
            display: flex;
            flex-direction: column;
        }
        
        .username-mini {
            font-size: 14px;
            font-weight: 700;
            color: var(--star-white);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 120px;
        }
        
        .user-id-mini {
            font-size: 11px;
            color: var(--star-light);
            font-family: 'Courier New', monospace;
            direction: ltr;
            opacity: 0.8;
        }
        
        .header-right {
            display: flex;
            align-items: center;
        }
        
        .total-balance-header {
            background: rgba(0, 217, 255, 0.1);
            padding: 10px 16px;
            border-radius: var(--radius-lg);
            border: var(--border-blue);
            text-align: left;
            min-width: 150px;
        }
        
        .balance-amount-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 4px;
        }
        
        .balance-amount-header i {
            font-size: 16px;
            color: var(--neon-blue);
        }
        
        .balance-amount-header span:first-of-type {
            font-size: 18px;
            font-weight: 800;
            color: var(--star-white);
            font-family: 'Courier New', monospace;
        }
        
        .balance-amount-header .currency {
            font-size: 12px;
            color: var(--star-light);
        }
        
        .balance-usd-header {
            font-size: 12px;
            color: var(--star-light);
            text-align: left;
            opacity: 0.8;
        }
        
        #admin-logo {
            font-size: 22px;
            color: var(--neon-green);
            margin-right: var(--space-md);
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        #admin-logo:hover {
            transform: rotate(15deg) scale(1.1);
            text-shadow: 0 0 15px var(--alien-glow);
        }
        
        /* Main Content */
        #app-container {
            display: none;
            padding-top: 80px;
            padding-bottom: 90px;
            min-height: 100vh;
            position: relative;
        }
        
        /* Pages */
        .page {
            display: none;
            padding: var(--space-md);
            animation: slideUp 0.3s ease;
        }
        
        .page.active {
            display: block;
        }
        
        @keyframes slideUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Home Page - Mining Section */
        .mining-section {
            background: var(--gradient-card);
            border-radius: var(--radius-xl);
            padding: var(--space-lg);
            margin-bottom: var(--space-md);
            border: var(--border-space);
            box-shadow: var(--shadow-card);
            position: relative;
            overflow: hidden;
        }
        
        .mining-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--gradient-neon);
        }
        
        .mining-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-lg);
            padding-bottom: var(--space-md);
            border-bottom: var(--border-space);
        }
        
        .mining-header h3 {
            font-size: 20px;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: var(--space-sm);
        }
        
        .mining-header h3 i {
            color: var(--neon-green);
            font-size: 22px;
        }
        
        .mining-stats {
            display: flex;
            gap: var(--space-lg);
        }
        
        .stat-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 6px;
        }
        
        .stat-label {
            font-size: 12px;
            color: var(--star-light);
            text-transform: uppercase;
            letter-spacing: 1px;
            font-weight: 500;
        }
        
        .stat-value {
            font-size: 20px;
            font-weight: 800;
            color: var(--neon-green);
            font-family: 'Courier New', monospace;
            text-shadow: 0 0 10px var(--neon-green);
        }
        
        .mining-timer-card {
            background: rgba(0, 0, 0, 0.3);
            border-radius: var(--radius-lg);
            padding: var(--space-lg);
            margin-bottom: var(--space-lg);
            text-align: center;
            border: var(--border-neon);
            position: relative;
            overflow: hidden;
        }
        
        .timer-display {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: var(--space-sm);
            margin-bottom: var(--space-sm);
        }
        
        .timer-display i {
            font-size: 24px;
            color: var(--neon-green);
        }
        
        #mining-timer-display {
            font-size: 32px;
            font-weight: 800;
            font-family: 'Courier New', monospace;
            color: var(--star-white);
            letter-spacing: 3px;
            text-shadow: 0 0 10px var(--neon-green);
        }
        
        .next-reward {
            font-size: 14px;
            color: var(--star-light);
        }
        
        .next-reward span {
            color: var(--neon-green);
            font-weight: 700;
        }
        
        #start-mining-btn {
            width: 100%;
            padding: var(--space-lg);
            background: var(--gradient-neon);
            border: none;
            border-radius: var(--radius-lg);
            color: var(--space-black);
            font-size: 18px;
            font-weight: 800;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: var(--space-sm);
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: var(--space-lg);
            box-shadow: var(--shadow-neon);
            position: relative;
            overflow: hidden;
            z-index: 1;
        }
        
        #start-mining-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transform: translateX(-100%);
            transition: transform 0.6s;
            z-index: -1;
        }
        
        #start-mining-btn:hover::before {
            transform: translateX(100%);
        }
        
        #start-mining-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0, 255, 157, 0.6);
        }
        
        #start-mining-btn:active {
            transform: translateY(-1px);
        }
        
        #start-mining-btn.claim-mode {
            background: linear-gradient(135deg, var(--neon-purple), var(--neon-pink));
            box-shadow: var(--shadow-purple);
        }
        
        .mining-info {
            display: flex;
            justify-content: space-between;
            gap: var(--space-sm);
            flex-wrap: wrap;
        }
        
        .info-item {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            font-size: 14px;
            color: var(--star-light);
            padding: 10px 14px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: var(--radius-md);
            border: var(--border-space);
            flex: 1;
            min-width: 150px;
        }
        
        .info-item i {
            font-size: 16px;
            color: var(--neon-green);
        }
        
        .info-item span span {
            color: var(--star-white);
            font-weight: 700;
            font-family: 'Courier New', monospace;
        }
        
        /* Upgrade Section */
        .upgrade-section {
            background: var(--gradient-card);
            border-radius: var(--radius-xl);
            padding: var(--space-lg);
            margin-bottom: var(--space-md);
            border: var(--border-space);
            box-shadow: var(--shadow-card);
        }
        
        .upgrade-section h4 {
            font-size: 18px;
            margin-bottom: var(--space-lg);
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            color: var(--star-white);
        }
        
        .upgrade-section h4 i {
            color: var(--neon-blue);
        }
        
        .upgrade-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: var(--space-md);
        }
        
        .upgrade-card {
            background: linear-gradient(145deg, rgba(26, 26, 58, 0.8), rgba(42, 26, 74, 0.8));
            border-radius: var(--radius-lg);
            padding: var(--space-md);
            border: var(--border-space);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .upgrade-card:hover {
            border-color: var(--neon-blue);
            transform: translateY(-5px);
        }
        
        .upgrade-card.active {
            border-color: var(--neon-green);
            box-shadow: var(--shadow-neon);
        }
        
        .upgrade-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-md);
        }
        
        .upgrade-level {
            font-size: 11px;
            font-weight: 700;
            color: var(--star-light);
            background: rgba(255, 255, 255, 0.1);
            padding: 4px 8px;
            border-radius: var(--radius-sm);
        }
        
        .upgrade-name {
            font-size: 16px;
            font-weight: 700;
            color: var(--star-white);
        }
        
        .upgrade-stats {
            margin-bottom: var(--space-md);
        }
        
        .upgrade-stat {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 13px;
            color: var(--star-light);
            margin-bottom: 6px;
        }
        
        .upgrade-stat i {
            font-size: 14px;
            width: 18px;
            text-align: center;
            color: var(--neon-green);
        }
        
        .upgrade-btn {
            width: 100%;
            padding: 12px;
            font-size: 14px;
            font-weight: 700;
            border: none;
            border-radius: var(--radius-md);
            cursor: pointer;
            transition: all 0.3s ease;
            background: rgba(0, 217, 255, 0.2);
            color: var(--neon-blue);
            border: var(--border-blue);
        }
        
        .upgrade-btn:hover:not(:disabled) {
            background: rgba(0, 217, 255, 0.3);
            transform: translateY(-2px);
        }
        
        .upgrade-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .upgrade-btn.active-btn {
            background: rgba(0, 255, 157, 0.2);
            color: var(--neon-green);
            border-color: rgba(0, 255, 157, 0.3);
        }
        
        /* Navigation - Space Style */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--gradient-header);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-top: var(--border-space);
            display: flex;
            justify-content: space-around;
            padding: 12px 0;
            z-index: 1000;
            box-shadow: var(--shadow-nav);
        }
        
        .nav-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 6px;
            padding: 8px 16px;
            background: transparent;
            border: none;
            border-radius: var(--radius-lg);
            color: var(--star-light);
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            flex: 1;
            max-width: 100px;
            position: relative;
        }
        
        .nav-btn i {
            font-size: 22px;
            transition: all 0.3s ease;
        }
        
        .nav-btn span {
            font-size: 12px;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .nav-btn.active {
            color: var(--neon-green);
            background: rgba(0, 255, 157, 0.15);
        }
        
        .nav-btn.active i {
            color: var(--neon-green);
            transform: translateY(-3px);
        }
        
        .nav-btn.active span {
            color: var(--neon-green);
            font-weight: 700;
        }
        
        .nav-btn:not(.active):hover {
            background: rgba(255, 255, 255, 0.05);
            color: var(--star-white);
        }
        
        /* Staking Page */
        .staking-content {
            padding: var(--space-md);
        }
        
        .staking-card {
            background: var(--gradient-card);
            border-radius: var(--radius-xl);
            padding: var(--space-lg);
            margin-bottom: var(--space-md);
            border: var(--border-space);
            box-shadow: var(--shadow-card);
        }
        
        .staking-card h4 {
            font-size: 20px;
            margin-bottom: var(--space-md);
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            color: var(--star-white);
        }
        
        .staking-card h4 i {
            color: var(--neon-purple);
        }
        
        .staking-plans-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: var(--space-md);
            margin-top: var(--space-lg);
        }
        
        .plan-item {
            background: linear-gradient(145deg, rgba(26, 26, 58, 0.8), rgba(42, 26, 74, 0.8));
            border-radius: var(--radius-lg);
            padding: var(--space-lg);
            border: var(--border-space);
            text-align: center;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .plan-item:hover {
            border-color: var(--neon-purple);
            transform: translateY(-5px);
            box-shadow: var(--shadow-purple);
        }
        
        .plan-name {
            font-size: 16px;
            font-weight: 700;
            color: var(--star-white);
            margin-bottom: var(--space-sm);
        }
        
        .plan-amount {
            font-size: 22px;
            font-weight: 800;
            color: var(--neon-purple);
            margin-bottom: 4px;
            font-family: 'Courier New', monospace;
            text-shadow: 0 0 10px var(--neon-purple);
        }
        
        .plan-duration {
            font-size: 13px;
            color: var(--star-light);
            margin-bottom: 4px;
        }
        
        .plan-apr {
            font-size: 16px;
            color: var(--neon-green);
            font-weight: 800;
            margin-bottom: var(--space-sm);
        }
        
        .plan-reward {
            font-size: 13px;
            color: var(--star-light);
            margin-bottom: var(--space-md);
        }
        
        .stake-plan-btn {
            width: 100%;
            padding: 12px;
            background: linear-gradient(135deg, var(--neon-purple), #7b2cbf);
            border: none;
            border-radius: var(--radius-md);
            color: white;
            font-size: 14px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            z-index: 1;
        }
        
        .stake-plan-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(157, 78, 221, 0.4);
        }
        
        #total-staked {
            font-size: 24px;
            font-weight: 800;
            color: var(--neon-green);
            font-family: 'Courier New', monospace;
            text-shadow: 0 0 10px var(--neon-green);
        }
        
        #active-stakes-list {
            min-height: 150px;
        }
        
        /* Wallet Page */
        .wallet-content {
            padding: var(--space-md);
        }
        
        .wallet-balance-card {
            background: var(--gradient-card);
            border-radius: var(--radius-xl);
            padding: var(--space-xl);
            margin-bottom: var(--space-md);
            border: var(--border-space);
            box-shadow: var(--shadow-card);
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .wallet-balance-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--gradient-neon);
        }
        
        .wallet-balance-card h4 {
            font-size: 20px;
            margin-bottom: var(--space-md);
            color: var(--star-white);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-sm);
        }
        
        .wallet-balance-card h4 i {
            color: var(--neon-blue);
        }
        
        .wallet-balance-amount {
            font-size: 42px;
            font-weight: 900;
            color: var(--neon-green);
            margin-bottom: 4px;
            font-family: 'Courier New', monospace;
            text-shadow: 0 0 15px var(--neon-green);
        }
        
        .wallet-balance-usd {
            font-size: 16px;
            color: var(--star-light);
            margin-bottom: var(--space-xl);
            font-weight: 500;
        }
        
        .wallet-actions {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: var(--space-md);
            margin-bottom: var(--space-lg);
        }
        
        .wallet-action-btn {
            padding: var(--space-lg);
            background: linear-gradient(145deg, rgba(26, 26, 58, 0.8), rgba(42, 26, 74, 0.8));
            border: var(--border-space);
            border-radius: var(--radius-lg);
            color: var(--star-white);
            font-size: 14px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: var(--space-sm);
        }
        
        .wallet-action-btn i {
            font-size: 24px;
            color: var(--neon-blue);
        }
        
        .wallet-action-btn:hover {
            border-color: var(--neon-blue);
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0, 217, 255, 0.3);
        }
        
        .wallet-assets {
            margin-top: var(--space-lg);
        }
        
        .wallet-assets h5 {
            font-size: 18px;
            color: var(--star-white);
            margin-bottom: var(--space-md);
            display: flex;
            align-items: center;
            gap: var(--space-sm);
        }
        
        .wallet-assets h5 i {
            color: var(--neon-green);
        }
        
        .asset-list {
            display: flex;
            flex-direction: column;
            gap: var(--space-sm);
        }
        
        .asset-item {
            display: flex;
            align-items: center;
            padding: var(--space-lg);
            background: linear-gradient(145deg, rgba(26, 26, 58, 0.8), rgba(42, 26, 74, 0.8));
            border-radius: var(--radius-lg);
            border: var(--border-space);
            gap: var(--space-md);
            transition: all 0.3s ease;
        }
        
        .asset-item:hover {
            border-color: var(--neon-green);
            transform: translateX(-5px);
        }
        
        .asset-icon {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(0, 255, 157, 0.1);
            border: 2px solid rgba(0, 255, 157, 0.3);
        }
        
        .asset-icon i {
            font-size: 22px;
            color: var(--neon-green);
        }
        
        .asset-icon.usdt {
            background: rgba(59, 130, 246, 0.1);
            border-color: rgba(59, 130, 246, 0.3);
        }
        
        .asset-icon.usdt i {
            color: #3b82f6;
        }
        
        .asset-icon.bnb {
            background: rgba(240, 185, 11, 0.1);
            border-color: rgba(240, 185, 11, 0.3);
        }
        
        .asset-icon.bnb i {
            color: #f0b90b;
        }
        
        .asset-icon.ton {
            background: rgba(0, 168, 232, 0.1);
            border-color: rgba(0, 168, 232, 0.3);
        }
        
        .asset-icon.ton i {
            color: #00a8e8;
        }
        
        .asset-details {
            flex: 1;
        }
        
        .asset-name {
            font-size: 16px;
            font-weight: 700;
            color: var(--star-white);
            margin-bottom: 4px;
        }
        
        .asset-balance {
            font-size: 14px;
            color: var(--star-light);
            font-family: 'Courier New', monospace;
        }
        
        .asset-value {
            font-size: 16px;
            font-weight: 700;
            color: var(--star-white);
            text-align: left;
        }
        
        /* Referral Page */
        .referral-content {
            padding: var(--space-md);
        }
        
        .referral-stats-card {
            background: var(--gradient-card);
            border-radius: var(--radius-xl);
            padding: var(--space-xl);
            margin-bottom: var(--space-md);
            border: var(--border-space);
            box-shadow: var(--shadow-card);
        }
        
        .referral-stats-card h4 {
            font-size: 20px;
            margin-bottom: var(--space-lg);
            color: var(--star-white);
            display: flex;
            align-items: center;
            gap: var(--space-sm);
        }
        
        .referral-stats-card h4 i {
            color: var(--neon-pink);
        }
        
        .referral-stats {
            display: flex;
            justify-content: space-around;
            text-align: center;
        }
        
        .ref-stat {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: var(--space-sm);
        }
        
        .ref-stat-value {
            font-size: 32px;
            font-weight: 900;
            color: var(--neon-pink);
            font-family: 'Courier New', monospace;
            text-shadow: 0 0 10px var(--neon-pink);
        }
        
        .ref-stat-label {
            font-size: 13px;
            color: var(--star-light);
            font-weight: 500;
        }
        
        .referral-code-card {
            background: var(--gradient-card);
            border-radius: var(--radius-xl);
            padding: var(--space-xl);
            margin-bottom: var(--space-md);
            border: var(--border-space);
            box-shadow: var(--shadow-card);
            text-align: center;
        }
        
        .referral-code-card h4 {
            font-size: 18px;
            margin-bottom: var(--space-lg);
            color: var(--star-white);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-sm);
        }
        
        .referral-code-card h4 i {
            color: var(--neon-purple);
        }
        
        #referral-code-display {
            font-size: 24px;
            font-weight: 800;
            color: var(--neon-pink);
            font-family: 'Courier New', monospace;
            padding: var(--space-lg);
            background: rgba(255, 0, 170, 0.1);
            border-radius: var(--radius-lg);
            border: var(--border-space);
            margin-bottom: var(--space-xl);
            letter-spacing: 2px;
            text-shadow: 0 0 10px var(--neon-pink);
        }
        
        .referral-link-card {
            background: linear-gradient(145deg, rgba(26, 26, 58, 0.8), rgba(42, 26, 74, 0.8));
            border-radius: var(--radius-xl);
            padding: var(--space-lg);
            border: var(--border-space);
            margin-bottom: var(--space-lg);
        }
        
        .referral-link-card h4 {
            font-size: 16px;
            margin-bottom: var(--space-md);
            color: var(--star-white);
            display: flex;
            align-items: center;
            gap: var(--space-sm);
        }
        
        .referral-link-card h4 i {
            color: var(--neon-blue);
        }
        
        .link-input-group {
            display: flex;
            gap: var(--space-sm);
            margin-bottom: var(--space-md);
        }
        
        #referral-link-input {
            flex: 1;
            padding: 14px;
            background: rgba(255, 255, 255, 0.05);
            border: var(--border-space);
            border-radius: var(--radius-md);
            color: var(--star-white);
            font-size: 14px;
            font-family: 'Courier New', monospace;
        }
        
        .copy-link-btn {
            padding: 0 20px;
            background: rgba(0, 217, 255, 0.1);
            border: var(--border-blue);
            border-radius: var(--radius-md);
            color: var(--neon-blue);
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            min-width: 50px;
        }
        
        .copy-link-btn:hover {
            background: rgba(0, 217, 255, 0.2);
            transform: scale(1.05);
        }
        
        .share-buttons {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: var(--space-md);
        }
        
        .share-btn {
            padding: 16px;
            border: none;
            border-radius: var(--radius-lg);
            color: white;
            font-size: 15px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-sm);
        }
        
        .share-btn.telegram {
            background: linear-gradient(135deg, #0088cc, #006699);
        }
        
        .share-btn.whatsapp {
            background: linear-gradient(135deg, #25D366, #128C7E);
        }
        
        .share-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.4);
        }
        
        .milestones-section {
            margin-top: var(--space-xl);
        }
        
        .milestones-section h5 {
            font-size: 18px;
            color: var(--star-white);
            margin-bottom: var(--space-md);
            display: flex;
            align-items: center;
            gap: var(--space-sm);
        }
        
        .milestones-section h5 i {
            color: var(--neon-green);
        }
        
        .milestones-list {
            display: flex;
            flex-direction: column;
            gap: var(--space-sm);
        }
        
        .milestone-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: var(--space-md);
            background: linear-gradient(145deg, rgba(26, 26, 58, 0.8), rgba(42, 26, 74, 0.8));
            border-radius: var(--radius-lg);
            border: var(--border-space);
            transition: all 0.3s ease;
        }
        
        .milestone-item.claimed {
            border-color: var(--neon-green);
            opacity: 0.8;
        }
        
        .milestone-item.can-claim {
            border-color: var(--neon-pink);
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { box-shadow: 0 0 0 0 rgba(255, 0, 170, 0.4); }
            50% { box-shadow: 0 0 0 10px rgba(255, 0, 170, 0); }
        }
        
        .milestone-item.locked {
            opacity: 0.6;
        }
        
        .milestone-info {
            display: flex;
            align-items: center;
            gap: var(--space-md);
        }
        
        .milestone-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255, 0, 170, 0.1);
            border: 2px solid rgba(255, 0, 170, 0.3);
        }
        
        .milestone-icon i {
            font-size: 18px;
            color: var(--neon-pink);
        }
        
        .milestone-details {
            display: flex;
            flex-direction: column;
        }
        
        .milestone-requirement {
            font-size: 14px;
            font-weight: 600;
            color: var(--star-white);
        }
        
        .milestone-reward {
            font-size: 16px;
            font-weight: 800;
            color: var(--neon-pink);
            font-family: 'Courier New', monospace;
        }
        
        .milestone-action button {
            padding: 10px 20px;
            background: linear-gradient(135deg, var(--neon-pink), #cc0099);
            border: none;
            border-radius: var(--radius-md);
            color: white;
            font-size: 13px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .milestone-action button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(255, 0, 170, 0.4);
        }
        
        /* Notifications */
        #notification-container {
            position: fixed;
            top: 90px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 10000;
            display: flex;
            flex-direction: column;
            gap: var(--space-sm);
            width: 90%;
            max-width: 400px;
        }
        
        .message {
            padding: var(--space-md) var(--space-lg);
            border-radius: var(--radius-lg);
            display: flex;
            align-items: center;
            gap: var(--space-md);
            font-size: 14px;
            font-weight: 600;
            animation: slideDown 0.3s ease;
            box-shadow: var(--shadow-card);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: var(--border-space);
        }
        
        .message i {
            font-size: 20px;
        }
        
        .message.success {
            background: rgba(0, 255, 157, 0.15);
            border-color: rgba(0, 255, 157, 0.3);
            color: var(--neon-green);
        }
        
        .message.error {
            background: rgba(255, 68, 68, 0.15);
            border-color: rgba(255, 68, 68, 0.3);
            color: #ff4444;
        }
        
        .message.warning {
            background: rgba(255, 193, 7, 0.15);
            border-color: rgba(255, 193, 7, 0.3);
            color: #ffc107;
        }
        
        .message.info {
            background: rgba(0, 217, 255, 0.15);
            border-color: rgba(0, 217, 255, 0.3);
            color: var(--neon-blue);
        }
        
        @keyframes slideDown {
            from { opacity: 0; transform: translateX(-50%) translateY(-30px); }
            to { opacity: 1; transform: translateX(-50%) translateY(0); }
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .app-header {
                height: 65px;
                padding: var(--space-sm) var(--space-sm);
            }
            
            #app-container {
                padding-top: 75px;
                padding-bottom: 85px;
            }
            
            .logo span {
                font-size: 16px;
            }
            
            .user-avatar-mini {
                width: 36px;
                height: 36px;
            }
            
            .username-mini {
                max-width: 100px;
                font-size: 13px;
            }
            
            .total-balance-header {
                min-width: 130px;
                padding: 8px 12px;
            }
            
            .balance-amount-header span:first-of-type {
                font-size: 16px;
            }
            
            .mining-header h3 {
                font-size: 18px;
            }
            
            .stat-value {
                font-size: 18px;
            }
            
            #mining-timer-display {
                font-size: 28px;
            }
            
            .wallet-balance-amount {
                font-size: 36px;
            }
            
            .upgrade-cards,
            .staking-plans-grid,
            .wallet-actions,
            .share-buttons {
                grid-template-columns: 1fr;
            }
            
            .bottom-nav {
                padding: 10px 0;
            }
            
            .nav-btn {
                padding: 6px 12px;
                font-size: 11px;
            }
            
            .nav-btn i {
                font-size: 20px;
            }
        }
        
        /* Hidden Elements */
        .hidden {
            display: none !important;
        }
    </style>
</head>
<body>
    <!-- Star Field Background -->
    <div id="star-field"></div>

    <!-- Loading Screen -->
    <div id="loading-screen" class="active">
        <div class="loading-container">
            <div class="alien-logo">ðŸ‘½</div>
            <div class="loading-title">ALIEN MUSK</div>
            <div class="loading-subtitle">Quantum Mining Platform v6.0</div>
            <div class="loading-progress">
                <div class="progress-bar">
                    <div id="loading-progress-bar"></div>
                </div>
                <span id="loading-progress-text">Initializing Quantum Engine...</span>
            </div>
        </div>
    </div>

    <!-- Main App Container -->
    <div id="app-container" class="hidden">
        <!-- Header -->
        <header class="app-header">
            <div class="header-left">
                <div class="logo">
                    <i class="fas fa-robot"></i>
                    <span>Alien Musk</span>
                </div>
                <div class="user-info-mini">
                    <img id="user-avatar-mini" class="user-avatar-mini" 
                         src="https://api.dicebear.com/7.x/avataaars/svg?seed=alien" 
                         alt="Avatar">
                    <div class="user-details-mini">
                        <span id="username-mini" class="username-mini">Alien</span>
                        <span id="user-id-mini" class="user-id-mini">ID: ---</span>
                    </div>
                </div>
            </div>
            
            <div class="header-right">
                <i class="fas fa-gem" id="admin-logo"></i>
                <div class="total-balance-header">
                    <div class="balance-amount-header">
                        <i class="fas fa-gem"></i>
                        <span id="total-balance-amsk">2,500</span>
                        <span class="currency">AMSK</span>
                    </div>
                    <div class="balance-usd-header">
                        â‰ˆ $<span id="total-balance-usd">0.50</span>
                    </div>
                </div>
            </div>
        </header>

        <!-- Home Page -->
        <div id="home-page" class="page active">
            <!-- Mining section will be populated by JavaScript -->
        </div>

        <!-- Staking Page -->
        <div id="staking-page" class="page">
            <div class="staking-content">
                <div class="staking-card">
                    <h4><i class="fas fa-gem"></i> Staking Platform</h4>
                    <div class="staking-info">
                        <p style="color: var(--star-light); margin-bottom: var(--space-md);">
                            Stake your USDT and earn AMSK tokens with high APR returns. Funds are locked for the duration.
                        </p>
                        <div style="display: flex; justify-content: space-between; align-items: center; background: rgba(0,0,0,0.3); padding: var(--space-md); border-radius: var(--radius-md); border: var(--border-space);">
                            <span style="color: var(--star-light);">Total Staked:</span>
                            <span id="total-staked" style="color: var(--neon-green); font-weight: 800; font-family: 'Courier New', monospace; font-size: 22px;">0 USDT</span>
                        </div>
                    </div>
                    
                    <div class="staking-plans-grid">
                        <!-- Plans will be populated by JavaScript -->
                    </div>
                </div>
                
                <div class="staking-card">
                    <h4><i class="fas fa-clock"></i> Active Stakes</h4>
                    <div id="active-stakes-list" style="min-height: 150px; display: flex; align-items: center; justify-content: center; color: var(--star-light); padding: var(--space-lg);">
                        <div style="text-align: center;">
                            <i class="fas fa-inbox" style="font-size: 48px; margin-bottom: var(--space-md); opacity: 0.5;"></i>
                            <p>No active stakes yet</p>
                            <small style="opacity: 0.7;">Start staking to earn rewards</small>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Wallet Page -->
        <div id="wallet-page" class="page">
            <div class="wallet-content">
                <div class="wallet-balance-card">
                    <h4><i class="fas fa-wallet"></i> Total Balance</h4>
                    <div class="wallet-balance-amount" id="wallet-balance-amsk">0</div>
                    <div class="wallet-balance-usd" id="wallet-balance-usd">â‰ˆ $0.00</div>
                    
                    <div class="wallet-actions">
                        <button class="wallet-action-btn" id="deposit-btn">
                            <i class="fas fa-download"></i>
                            <span>Deposit</span>
                        </button>
                        <button class="wallet-action-btn" id="withdraw-btn">
                            <i class="fas fa-upload"></i>
                            <span>Withdraw</span>
                        </button>
                        <button class="wallet-action-btn" id="swap-btn">
                            <i class="fas fa-exchange-alt"></i>
                            <span>Swap</span>
                        </button>
                        <button class="wallet-action-btn" id="history-btn">
                            <i class="fas fa-history"></i>
                            <span>History</span>
                        </button>
                    </div>
                </div>
                
                <div class="wallet-assets">
                    <h5><i class="fas fa-coins"></i> My Assets</h5>
                    <div class="asset-list">
                        <!-- Assets will be populated by JavaScript -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Referral Page -->
        <div id="referral-page" class="page">
            <div class="referral-content">
                <!-- Referral content will be populated by JavaScript -->
            </div>
        </div>
    </div>

    <!-- Bottom Navigation -->
    <nav class="bottom-nav">
        <button class="nav-btn active" data-page="home">
            <i class="fas fa-home"></i>
            <span>Home</span>
        </button>
        <button class="nav-btn" data-page="staking">
            <i class="fas fa-gem"></i>
            <span>Staking</span>
        </button>
        <button class="nav-btn" data-page="wallet">
            <i class="fas fa-wallet"></i>
            <span>Wallet</span>
        </button>
        <button class="nav-btn" data-page="referral">
            <i class="fas fa-users"></i>
            <span>Referral</span>
        </button>
    </nav>

    <!-- Notification Container -->
    <div id="notification-container"></div>

    <!-- Main Application JavaScript -->
    <script>
        // ============================================
        // ALIEN MUSK - Quantum Mining Platform v6.0
        // PROFESSIONAL EDITION WITH ADMIN PANEL & WALLET
        // ============================================
        
        // Telegram WebApp
        let tg = null;
        try {
            tg = window.Telegram.WebApp;
            if (tg) {
                tg.ready();
                tg.expand();
                tg.setHeaderColor('#0a0a0f');
                tg.setBackgroundColor('#0a0a0f');
                console.log("âœ… Telegram WebApp initialized");
            }
        } catch (e) {
            console.log("âš ï¸ Not in Telegram environment");
        }

        // Firebase Configuration
        const FIREBASE_CONFIG = {
            apiKey: "AIzaSyCklv_zMfndK4-xUHECyD5XA7p_-20e1t8",
            authDomain: "tatbi9-681bf.firebaseapp.com",
            projectId: "tatbi9-681bf",
            storageBucket: "tatbi9-681bf.firebasestorage.app",
            messagingSenderId: "863237064748",
            appId: "1:863237064748:web:134de1e01d2639ef5fa989"
        };

        // Initialize Firebase
        let firebaseApp, db;
        if (typeof firebase !== 'undefined') {
            try {
                firebaseApp = firebase.initializeApp(FIREBASE_CONFIG);
                db = firebase.firestore();
                console.log("âœ… Firebase initialized");
            } catch (error) {
                console.error("âŒ Firebase error:", error);
            }
        }

        // ============================================
        // CONFIGURATION - UPDATED
        // ============================================
        const CONFIG = {
            // Token Prices (USD)
            PRICES: {
                AMSK: 0.0002,
                USDT: 1.00,
                BNB: 752.00,
                TON: 1.32
            },
            
            // Deposit Minimums
            MIN_DEPOSIT: {
                USDT: 10,
                BNB: 0.02,
                TON: 10
            },
            
            // Withdrawal Settings
            WITHDRAWAL: {
                MIN_USDT: 100,
                FEE_BNB: 0.0002,
                FEE_USD: 0.15
            },
            
            // Deposit Addresses
            ADDRESSES: {
                TON: "UQBCqpsPGRG3BalS10iF5U8-PSXkbE5ZlpQRqPVJaGglvQDJ",
                BNB_USDT: "0x790CAB511055F63db2F30AD227f7086bA3B6376a"
            },
            
            // Mining Configuration - UPDATED WITH MORE LEVELS
            MINING: {
                DURATION: 60000, // 1 minute for testing (change to 3600000 for production)
                
                LEVELS: {
                    1: { name: "Beginner", cost: 0, reward: 2500, hashrate: 2500 },
                    2: { name: "Advanced", cost: 5, reward: 5000, hashrate: 5000 },
                    3: { name: "Pro", cost: 20, reward: 10000, hashrate: 10000 },
                    4: { name: "Expert", cost: 100, reward: 25000, hashrate: 25000 },
                    5: { name: "Master", cost: 500, reward: 50000, hashrate: 50000 },
                    6: { name: "Elite", cost: 1000, reward: 100000, hashrate: 100000 }
                },
                
                BOOSTERS: {
                    "2x": { multiplier: 2, duration: 86400000, price: 10000 },
                    "3x": { multiplier: 3, duration: 43200000, price: 15000 },
                    "5x": { multiplier: 5, duration: 21600000, price: 25000 }
                }
            },
            
            // Staking Configuration - FIXED CALCULATIONS
            STAKING: {
                PLANS: {
                    1: { 
                        name: "Silver", 
                        minAmount: 10, 
                        maxAmount: 1000,
                        duration: 7, 
                        apr: 40, 
                        dailyPer100: 571.43
                    },
                    2: { 
                        name: "Gold", 
                        minAmount: 50, 
                        maxAmount: 5000,
                        duration: 15, 
                        apr: 50, 
                        dailyPer100: 416.67
                    },
                    3: { 
                        name: "Diamond", 
                        minAmount: 100, 
                        maxAmount: 10000,
                        duration: 30, 
                        apr: 60, 
                        dailyPer100: 333.33
                    }
                }
            },
            
            // Referral Configuration - UPDATED WITH MILESTONES
            REFERRAL: {
                DIRECT_REWARD: 10000, // 10,000 AMSK for referrer
                WELCOME_BONUS: 5000, // 5,000 AMSK for new user
                
                MILESTONES: {
                    10: 50000,   // 50,000 AMSK
                    25: 150000,  // 150,000 AMSK
                    50: 350000,  // 350,000 AMSK
                    100: 1000000 // 1,000,000 AMSK
                }
            },
            
            // Admin Configuration
            ADMIN: {
                TELEGRAM_ID: "1653918641",
                PASSWORD: "Ali97$",
                SECRET_CODE: "ALIEN2024"
            },
            
            // Swap Configuration
            SWAP: {
                MIN_AMSK: 1000,
                MIN_USDT: 10,
                RATE_AMSK_USDT: 5000, // 1 USDT = 5,000 AMSK
                FEE_PERCENT: 0.1
            },
            
            // UI Configuration
            UI: {
                ANIMATION_DURATION: 300,
                NOTIFICATION_DURATION: 4000
            }
        };

        // ============================================
        // USER DATA MANAGEMENT
        // ============================================
        let userData = {
            id: null,
            telegramId: null,
            username: 'Alien',
            firstName: 'Alien',
            photoUrl: null,
            referralCode: null,
            referredBy: null,
            joinedAt: null,
            lastActive: null,
            isInitialized: false,
            lastSaveTime: 0
        };

        // WALLET DATA
        let walletData = {
            balances: {
                AMSK: 2500,
                USDT: 0,
                BNB: 0,
                TON: 0
            },
            mining: {
                level: 1,
                active: false,
                lastReward: null,
                nextReward: null,
                totalMined: 2500,
                minedToday: 2500,
                activeBoosters: []
            },
            staking: {
                activeStakes: [],
                totalEarned: 0,
                totalStaked: 0
            },
            referrals: {
                count: 0,
                earned: 0,
                referrals: [],
                claimedMilestones: [],
                pendingMilestones: []
            },
            pendingDeposits: [],
            pendingWithdrawals: [],
            depositHistory: [],
            withdrawalHistory: [],
            usedTransactions: [],
            lastUpdate: Date.now()
        };

        // ADMIN SYSTEM
        let adminAccess = false;
        let gemClickCount = 0;
        let lastGemClickTime = 0;

        // ELEMENTS CACHE
        const elements = {};

        // INTERVALS
        let intervals = {
            miningTimer: null,
            autoSave: null,
            updateTimer: null
        };

        // ============================================
        // STAR FIELD BACKGROUND
        // ============================================
        function createStarfield() {
            const starField = document.getElementById('star-field');
            if (!starField) return;
            
            for (let i = 0; i < 100; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                
                const size = Math.random() * 3 + 1;
                star.style.width = `${size}px`;
                star.style.height = `${size}px`;
                star.style.left = `${Math.random() * 100}%`;
                star.style.top = `${Math.random() * 100}%`;
                star.style.opacity = Math.random() * 0.5 + 0.2;
                star.style.animationDelay = `${Math.random() * 5}s`;
                star.style.animationDuration = `${Math.random() * 3 + 2}s`;
                
                starField.appendChild(star);
            }
        }

        // ============================================
        // INITIALIZATION - FIXED
        // ============================================
        async function initAlienMuskApp() {
            console.log("ðŸš€ Initializing Alien Musk Platform v6.0...");
            
            try {
                // 1. Create star field
                createStarfield();
                
                // 2. Update loading progress
                updateLoadingProgress('Loading Quantum Engine...', 25);
                
                // 3. Cache DOM Elements
                await cacheElements();
                
                // 4. Setup User
                await setupUser();
                updateLoadingProgress('Initializing user data...', 50);
                
                // 5. Load Data
                await loadUserData();
                updateLoadingProgress('Setting up mining system...', 75);
                
                // 6. Setup Event Listeners
                setupEventListeners();
                
                // 7. Check for Referral
                await checkForReferral();
                
                // 8. Generate HTML content
                generatePageContent();
                
                // 9. Update UI
                updateUI();
                
                // 10. Complete loading
                updateLoadingProgress('Platform Ready!', 100);
                
                setTimeout(() => {
                    hideLoading();
                    showMessage("ðŸ‘½ Welcome to Alien Musk Quantum Platform!", "success");
                    
                    // Start Background Services
                    startBackgroundServices();
                    
                    // Setup Admin System
                    initAdminSystem();
                    
                    // Setup Real-time Listeners
                    setupRealTimeListeners();
                    
                    userData.isInitialized = true;
                    console.log("âœ… Platform initialized successfully");
                }, 500);
                
            } catch (error) {
                console.error("âŒ Initialization failed:", error);
                showMessage("Failed to initialize platform", "error");
                hideLoading();
            }
        }

        // Loading Progress
        function updateLoadingProgress(text, percent) {
            const bar = document.getElementById('loading-progress-bar');
            const textEl = document.getElementById('loading-progress-text');
            
            if (bar) bar.style.width = percent + '%';
            if (textEl) textEl.textContent = text;
        }

        function hideLoading() {
            const loadingScreen = document.getElementById('loading-screen');
            const appContainer = document.getElementById('app-container');
            
            if (loadingScreen) {
                loadingScreen.style.opacity = '0';
                setTimeout(() => {
                    loadingScreen.style.display = 'none';
                }, 500);
            }
            
            if (appContainer) {
                appContainer.style.display = 'block';
            }
        }

        // ============================================
        // HTML CONTENT GENERATION
        // ============================================
        function generatePageContent() {
            generateHomePage();
            generateStakingPage();
            generateWalletPage();
            generateReferralPage();
        }

        function generateHomePage() {
            const homePage = document.getElementById('home-page');
            if (!homePage) return;
            
            homePage.innerHTML = `
                <div class="mining-section">
                    <div class="mining-header">
                        <h3><i class="fas fa-microchip"></i> Quantum Mining</h3>
                        <div class="mining-stats">
                            <div class="stat-item">
                                <span class="stat-label">Level</span>
                                <span id="current-mining-level" class="stat-value">1</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Hashrate</span>
                                <span id="current-hashrate-display" class="stat-value">2,500</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mining-timer-card">
                        <div class="timer-display">
                            <i class="fas fa-clock"></i>
                            <span id="mining-timer-display">01:00:00</span>
                        </div>
                        <div class="next-reward">
                            Next reward: <span id="next-reward-amount">2,500</span> AMSK
                        </div>
                    </div>
                    
                    <button id="start-mining-btn" class="mining-action-btn">
                        <i class="fas fa-play"></i>
                        <span>Start Mining</span>
                    </button>
                    
                    <div class="mining-info">
                        <div class="info-item">
                            <i class="fas fa-chart-line"></i>
                            <span>Total Mined: <span id="total-mined">2,500</span> AMSK</span>
                        </div>
                        <div class="info-item">
                            <i class="fas fa-calendar-day"></i>
                            <span>Today: <span id="mined-today">2,500</span> AMSK</span>
                        </div>
                    </div>
                </div>

                <div class="upgrade-section">
                    <h4><i class="fas fa-level-up-alt"></i> Upgrade Mining Level</h4>
                    <div class="upgrade-cards" id="upgrade-cards-container">
                        ${generateUpgradeCards()}
                    </div>
                </div>
            `;
        }

        function generateUpgradeCards() {
            let html = '';
            for (let i = 1; i <= 6; i++) {
                const level = CONFIG.MINING.LEVELS[i];
                html += `
                    <div class="upgrade-card" data-level="${i}">
                        <div class="upgrade-header">
                            <div class="upgrade-level">Level ${i}</div>
                            <div class="upgrade-name">${level.name}</div>
                        </div>
                        <div class="upgrade-stats">
                            <div class="upgrade-stat">
                                <i class="fas fa-bolt"></i>
                                <span>Hashrate: ${level.hashrate.toLocaleString()}</span>
                            </div>
                            <div class="upgrade-stat">
                                <i class="fas fa-gift"></i>
                                <span>Reward: ${level.reward.toLocaleString()} AMSK</span>
                            </div>
                            ${i > 1 ? `
                            <div class="upgrade-stat">
                                <i class="fas fa-money-bill"></i>
                                <span>Cost: ${level.cost} USDT</span>
                            </div>
                            ` : ''}
                        </div>
                        <button class="upgrade-btn" onclick="upgradeMiningLevel(${i})" ${i === 1 ? 'disabled' : ''}>
                            ${i === 1 ? 'Active' : i > 1 ? `${level.cost} USDT` : 'Free'}
                        </button>
                    </div>
                `;
            }
            return html;
        }

        function generateStakingPage() {
            const stakingPage = document.getElementById('staking-page');
            if (!stakingPage) return;
            
            stakingPage.innerHTML = `
                <div class="staking-content">
                    <div class="staking-card">
                        <h4><i class="fas fa-gem"></i> Staking Platform</h4>
                        <div class="staking-info">
                            <p style="color: var(--star-light); margin-bottom: var(--space-md);">
                                Stake your USDT and earn AMSK tokens with high APR returns. Funds are locked for the duration.
                            </p>
                            <div style="display: flex; justify-content: space-between; align-items: center; background: rgba(0,0,0,0.3); padding: var(--space-md); border-radius: var(--radius-md); border: var(--border-space);">
                                <span style="color: var(--star-light);">Total Staked:</span>
                                <span id="total-staked" style="color: var(--neon-green); font-weight: 800; font-family: 'Courier New', monospace; font-size: 22px;">0 USDT</span>
                            </div>
                        </div>
                        
                        <div class="staking-plans-grid" id="staking-plans-container">
                            ${generateStakingPlans()}
                        </div>
                    </div>
                    
                    <div class="staking-card">
                        <h4><i class="fas fa-clock"></i> Active Stakes</h4>
                        <div id="active-stakes-list" style="min-height: 150px; display: flex; align-items: center; justify-content: center; color: var(--star-light); padding: var(--space-lg);">
                            <div style="text-align: center;">
                                <i class="fas fa-inbox" style="font-size: 48px; margin-bottom: var(--space-md); opacity: 0.5;"></i>
                                <p>No active stakes yet</p>
                                <small style="opacity: 0.7;">Start staking to earn rewards</small>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function generateStakingPlans() {
            let html = '';
            for (let i = 1; i <= 3; i++) {
                const plan = CONFIG.STAKING.PLANS[i];
                html += `
                    <div class="plan-item">
                        <div class="plan-name">${plan.name} Plan</div>
                        <div class="plan-amount">${plan.minAmount}-${plan.maxAmount} USDT</div>
                        <div class="plan-duration">${plan.duration} Days</div>
                        <div class="plan-apr">${plan.apr}% APR</div>
                        <div class="plan-reward">~${plan.dailyPer100.toFixed(0)} AMSK/Day per 100 USDT</div>
                        <button class="stake-plan-btn" data-plan="${i}" onclick="openStakeModal(${i})">Stake Now</button>
                    </div>
                `;
            }
            return html;
        }

        function generateWalletPage() {
            const walletPage = document.getElementById('wallet-page');
            if (!walletPage) return;
            
            walletPage.innerHTML = `
                <div class="wallet-content">
                    <div class="wallet-balance-card">
                        <h4><i class="fas fa-wallet"></i> Total Balance</h4>
                        <div class="wallet-balance-amount" id="wallet-balance-amsk">0</div>
                        <div class="wallet-balance-usd" id="wallet-balance-usd">â‰ˆ $0.00</div>
                        
                        <div class="wallet-actions">
                            <button class="wallet-action-btn" id="deposit-btn">
                                <i class="fas fa-download"></i>
                                <span>Deposit</span>
                            </button>
                            <button class="wallet-action-btn" id="withdraw-btn">
                                <i class="fas fa-upload"></i>
                                <span>Withdraw</span>
                            </button>
                            <button class="wallet-action-btn" id="swap-btn">
                                <i class="fas fa-exchange-alt"></i>
                                <span>Swap</span>
                            </button>
                            <button class="wallet-action-btn" id="history-btn">
                                <i class="fas fa-history"></i>
                                <span>History</span>
                            </button>
                        </div>
                    </div>
                    
                    <div class="wallet-assets">
                        <h5><i class="fas fa-coins"></i> My Assets</h5>
                        <div class="asset-list" id="asset-list-container">
                            ${generateAssetList()}
                        </div>
                    </div>
                </div>
            `;
        }

        function generateAssetList() {
            const assets = [
                { symbol: 'AMSK', name: 'Alien Musk', icon: 'fa-robot', class: '' },
                { symbol: 'USDT', name: 'Tether', icon: 'fa-coins', class: 'usdt' },
                { symbol: 'BNB', name: 'BNB', icon: 'fab fa-btc', class: 'bnb' },
                { symbol: 'TON', name: 'TON', icon: 'fa-rocket', class: 'ton' }
            ];
            
            let html = '';
            assets.forEach(asset => {
                html += `
                    <div class="asset-item">
                        <div class="asset-icon ${asset.class}">
                            <i class="${asset.icon}"></i>
                        </div>
                        <div class="asset-details">
                            <div class="asset-name">${asset.name} (${asset.symbol})</div>
                            <div class="asset-balance" id="wallet-${asset.symbol.toLowerCase()}-balance">0</div>
                        </div>
                        <div class="asset-value" id="wallet-${asset.symbol.toLowerCase()}-value">$0.00</div>
                    </div>
                `;
            });
            return html;
        }

        function generateReferralPage() {
            const referralPage = document.getElementById('referral-page');
            if (!referralPage) return;
            
            referralPage.innerHTML = `
                <div class="referral-content">
                    <div class="referral-stats-card">
                        <h4><i class="fas fa-users"></i> Referral Program</h4>
                        <div class="referral-stats">
                            <div class="ref-stat">
                                <div class="ref-stat-value" id="ref-count">0</div>
                                <div class="ref-stat-label">Total Referrals</div>
                            </div>
                            <div class="ref-stat">
                                <div class="ref-stat-value" id="ref-earned">0</div>
                                <div class="ref-stat-label">AMSK Earned</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="referral-code-card">
                        <h4><i class="fas fa-link"></i> Your Referral Code</h4>
                        <div class="referral-code-display" id="referral-code-display">Loading...</div>
                        <button onclick="copyReferralCode()" style="width: 100%; padding: 16px; background: linear-gradient(135deg, var(--neon-purple), #7b2cbf); border: none; border-radius: var(--radius-lg); color: white; font-size: 16px; font-weight: 700; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 10px; transition: all 0.3s ease;">
                            <i class="fas fa-copy"></i>
                            Copy Referral Code
                        </button>
                    </div>
                    
                    <div class="referral-link-card">
                        <h4><i class="fas fa-share-alt"></i> Share Your Link</h4>
                        <div class="link-input-group">
                            <input type="text" id="referral-link-input" class="link-input" value="Loading..." readonly>
                            <button onclick="copyReferralLink()" class="copy-link-btn">
                                <i class="fas fa-copy"></i>
                            </button>
                        </div>
                        <div class="share-buttons">
                            <button class="share-btn telegram" onclick="shareOnTelegram()">
                                <i class="fab fa-telegram"></i>
                                Telegram
                            </button>
                            <button class="share-btn whatsapp" onclick="shareOnWhatsApp()">
                                <i class="fab fa-whatsapp"></i>
                                WhatsApp
                            </button>
                        </div>
                    </div>
                    
                    <div class="milestones-section">
                        <h5><i class="fas fa-trophy"></i> Milestone Rewards</h5>
                        <div class="milestones-list" id="milestones-list-container">
                            ${generateMilestones()}
                        </div>
                    </div>
                </div>
            `;
        }

        function generateMilestones() {
            let html = '';
            const milestones = CONFIG.REFERRAL.MILESTONES;
            
            Object.keys(milestones).forEach((count, index) => {
                const reward = milestones[count];
                const icons = ['fa-user-plus', 'fa-users', 'fa-crown', 'fa-star'];
                html += `
                    <div class="milestone-item locked" data-milestone="${count}">
                        <div class="milestone-info">
                            <div class="milestone-icon">
                                <i class="fas ${icons[index] || 'fa-trophy'}"></i>
                            </div>
                            <div class="milestone-details">
                                <div class="milestone-requirement">Refer ${count} friends</div>
                                <div class="milestone-reward">${reward.toLocaleString()} AMSK</div>
                            </div>
                        </div>
                        <div class="milestone-action">
                            <span class="locked-badge">0/${count}</span>
                        </div>
                    </div>
                `;
            });
            return html;
        }

        // ============================================
        // CACHE DOM ELEMENTS
        // ============================================
        async function cacheElements() {
            console.log("ðŸ” Caching DOM elements...");
            
            // Loading screen
            elements.loadingScreen = document.getElementById('loading-screen');
            elements.loadingProgress = document.getElementById('loading-progress-bar');
            elements.loadingText = document.getElementById('loading-progress-text');
            
            // Header elements
            elements.usernameMini = document.getElementById('username-mini');
            elements.userIdMini = document.getElementById('user-id-mini');
            elements.userAvatarMini = document.getElementById('user-avatar-mini');
            elements.totalBalanceAmsk = document.getElementById('total-balance-amsk');
            elements.totalBalanceUsd = document.getElementById('total-balance-usd');
            elements.adminLogo = document.getElementById('admin-logo');
            
            // Navigation
            elements.navBtns = document.querySelectorAll('.nav-btn');
            elements.pages = document.querySelectorAll('.page');
            
            // Wait for HTML to be generated
            await new Promise(resolve => setTimeout(resolve, 100));
            
            // Mining elements
            elements.startMiningBtn = document.getElementById('start-mining-btn');
            elements.miningTimerDisplay = document.getElementById('mining-timer-display');
            elements.currentMiningLevel = document.getElementById('current-mining-level');
            elements.currentHashrateDisplay = document.getElementById('current-hashrate-display');
            elements.nextRewardAmount = document.getElementById('next-reward-amount');
            elements.totalMined = document.getElementById('total-mined');
            elements.minedToday = document.getElementById('mined-today');
            
            // Staking elements
            elements.stakeButtons = document.querySelectorAll('.stake-plan-btn');
            elements.totalStaked = document.getElementById('total-staked');
            elements.activeStakesList = document.getElementById('active-stakes-list');
            
            // Wallet elements
            elements.depositBtn = document.getElementById('deposit-btn');
            elements.withdrawBtn = document.getElementById('withdraw-btn');
            elements.swapBtn = document.getElementById('swap-btn');
            elements.historyBtn = document.getElementById('history-btn');
            
            // Referral elements
            elements.referralCodeDisplay = document.getElementById('referral-code-display');
            elements.referralLinkInput = document.getElementById('referral-link-input');
            elements.refCount = document.getElementById('ref-count');
            elements.refEarned = document.getElementById('ref-earned');
            
            console.log(`âœ… Cached ${Object.keys(elements).length} element groups`);
        }

        // ============================================
        // SETUP USER - FIXED ID SYSTEM
        // ============================================
        async function setupUser() {
            console.log("ðŸ‘¤ Setting up user...");
            
            let telegramUser = null;
            if (tg && tg.initDataUnsafe && tg.initDataUnsafe.user) {
                telegramUser = tg.initDataUnsafe.user;
                console.log("ðŸ“± Telegram user found:", telegramUser.id);
            }
            
            if (telegramUser && telegramUser.id) {
                userData.id = `tg_${telegramUser.id}`;
                userData.telegramId = telegramUser.id.toString();
                userData.username = telegramUser.username ? `@${telegramUser.username}` : 
                               telegramUser.first_name ? telegramUser.first_name : 
                               `User${telegramUser.id.toString().slice(-4)}`;
                userData.firstName = telegramUser.first_name || 'Alien';
                userData.photoUrl = telegramUser.photo_url || 
                               `https://api.dicebear.com/7.x/avataaars/svg?seed=${telegramUser.id}`;
            } else {
                let userId = localStorage.getItem('alien_musk_user_id');
                if (!userId) {
                    userId = 'web_' + Date.now().toString(36) + Math.random().toString(36).substr(2, 9);
                    localStorage.setItem('alien_musk_user_id', userId);
                }
                userData.id = userId;
                userData.username = 'Alien';
                userData.firstName = 'Alien';
                userData.photoUrl = `https://api.dicebear.com/7.x/avataaars/svg?seed=${userId}`;
            }
            
            if (!userData.referralCode) {
                userData.referralCode = generateReferralCode(userData.id);
                console.log("ðŸ”— Generated referral code:", userData.referralCode);
            }
            
            userData.joinedAt = new Date().toISOString();
            userData.lastActive = new Date().toISOString();
            
            console.log("ðŸ‘¤ User initialized:", {
                id: userData.id,
                refCode: userData.referralCode,
                name: userData.username
            });
            
            updateUserUI();
            
            if (db) {
                await syncUserWithFirebase();
            }
        }

        function generateReferralCode(userId) {
            const idPart = userId.slice(-6).toUpperCase().replace(/[^A-Z0-9]/g, '');
            const chars = 'ABCDEFGHJKLMNPQRSTUVWXYZ23456789';
            const randomPart = Array.from({length: 4}, () => 
                chars.charAt(Math.floor(Math.random() * chars.length))
            ).join('');
            
            return `ALIEN-${idPart}${randomPart}`;
        }

        // ============================================
        // DATA LOADING/SAVING
        // ============================================
        async function loadUserData() {
            console.log("ðŸ“‚ Loading user data for:", userData.id);
            
            try {
                if (db) {
                    const loaded = await loadUserFromFirebase();
                    if (loaded) {
                        console.log("âœ… Data loaded from Firebase");
                        await loadWalletFromFirebase();
                        return;
                    }
                }
                
                await loadUserFromLocalStorage();
                
            } catch (error) {
                console.error("âŒ Error loading user data:", error);
                initializeDefaultData();
            }
        }

        async function loadUserFromFirebase() {
            if (!db || !userData.id) return false;
            
            try {
                const userRef = db.collection('users').doc(userData.id);
                const userSnap = await userRef.get();
                
                if (userSnap.exists) {
                    const firebaseData = userSnap.data();
                    
                    if (firebaseData.balances) {
                        walletData.balances = firebaseData.balances;
                    }
                    
                    if (firebaseData.mining) {
                        walletData.mining = firebaseData.mining;
                    }
                    
                    if (firebaseData.staking) {
                        walletData.staking = firebaseData.staking;
                    }
                    
                    if (firebaseData.referrals) {
                        walletData.referrals = firebaseData.referrals;
                    }
                    
                    if (firebaseData.username) {
                        userData.username = firebaseData.username;
                    }
                    
                    if (firebaseData.referralCode) {
                        userData.referralCode = firebaseData.referralCode;
                    }
                    
                    if (firebaseData.referredBy) {
                        userData.referredBy = firebaseData.referredBy;
                    }
                    
                    return true;
                }
            } catch (error) {
                console.error("âŒ Firebase load error:", error);
            }
            
            return false;
        }

        async function loadWalletFromFirebase() {
            if (!db || !userData.id) return false;
            
            try {
                const walletRef = db.collection('wallets').doc(userData.id);
                const walletSnap = await walletRef.get();
                
                if (walletSnap.exists) {
                    const firebaseData = walletSnap.data();
                    
                    walletData.pendingDeposits = firebaseData.pendingDeposits || [];
                    walletData.pendingWithdrawals = firebaseData.pendingWithdrawals || [];
                    walletData.depositHistory = firebaseData.depositHistory || [];
                    walletData.withdrawalHistory = firebaseData.withdrawalHistory || [];
                    walletData.usedTransactions = firebaseData.usedTransactions || [];
                    
                    console.log("âœ… Wallet data loaded from Firebase");
                    return true;
                }
            } catch (error) {
                console.error("âŒ Wallet Firebase load error:", error);
            }
            
            return false;
        }

        async function loadUserFromLocalStorage() {
            const storageKey = `alien_musk_${userData.id}`;
            const savedData = localStorage.getItem(storageKey);
            
            if (savedData) {
                try {
                    const parsed = JSON.parse(savedData);
                    
                    if (parsed.balances) {
                        walletData.balances = {
                            AMSK: parsed.balances.AMSK || 2500,
                            USDT: parsed.balances.USDT || 0,
                            BNB: parsed.balances.BNB || 0,
                            TON: parsed.balances.TON || 0
                        };
                    }
                    
                    if (parsed.mining) {
                        walletData.mining = parsed.mining;
                    }
                    
                    if (parsed.staking) {
                        walletData.staking = parsed.staking;
                    }
                    
                    if (parsed.referrals) {
                        walletData.referrals = parsed.referrals;
                    }
                    
                    if (parsed.pendingDeposits) {
                        walletData.pendingDeposits = parsed.pendingDeposits;
                    }
                    
                    if (parsed.pendingWithdrawals) {
                        walletData.pendingWithdrawals = parsed.pendingWithdrawals;
                    }
                    
                    if (parsed.depositHistory) {
                        walletData.depositHistory = parsed.depositHistory;
                    }
                    
                    if (parsed.withdrawalHistory) {
                        walletData.withdrawalHistory = parsed.withdrawalHistory;
                    }
                    
                    if (parsed.usedTransactions) {
                        walletData.usedTransactions = parsed.usedTransactions;
                    }
                    
                    console.log("âœ… Data loaded from localStorage");
                    
                } catch (error) {
                    console.error("âŒ Parse error:", error);
                    initializeDefaultData();
                }
            } else {
                console.log("ðŸ“ No saved data found, using defaults");
                initializeDefaultData();
            }
        }

        function initializeDefaultData() {
            walletData.balances = { AMSK: 2500, USDT: 0, BNB: 0, TON: 0 };
            walletData.mining = {
                level: 1,
                active: false,
                lastReward: null,
                nextReward: null,
                totalMined: 2500,
                minedToday: 2500,
                activeBoosters: []
            };
            walletData.staking = {
                activeStakes: [],
                totalEarned: 0,
                totalStaked: 0
            };
            walletData.referrals = {
                count: 0,
                earned: 0,
                referrals: [],
                claimedMilestones: [],
                pendingMilestones: []
            };
        }

        async function syncUserWithFirebase() {
            if (!db || !userData.id) return;
            
            try {
                const userRef = db.collection('users').doc(userData.id);
                await userRef.set({
                    id: userData.id,
                    telegramId: userData.telegramId,
                    username: userData.username,
                    firstName: userData.firstName,
                    photoUrl: userData.photoUrl,
                    referralCode: userData.referralCode,
                    referredBy: userData.referredBy,
                    joinedAt: userData.joinedAt,
                    lastActive: userData.lastActive,
                    lastUpdate: firebase.firestore.FieldValue.serverTimestamp()
                }, { merge: true });
                
                console.log("âœ… User synced with Firebase");
            } catch (error) {
                console.error("âŒ Error syncing user with Firebase:", error);
            }
        }

        // ============================================
        // UI MANAGEMENT
        // ============================================
        function updateUserUI() {
            if (elements.usernameMini) {
                elements.usernameMini.textContent = userData.firstName;
            }
            
            if (elements.userIdMini) {
                elements.userIdMini.textContent = `ID: ${userData.id.slice(-8)}`;
            }
            
            if (elements.userAvatarMini) {
                elements.userAvatarMini.src = userData.photoUrl;
                elements.userAvatarMini.onerror = function() {
                    this.src = `https://api.dicebear.com/7.x/avataaars/svg?seed=${userData.id}`;
                };
            }
        }

        function updateUI() {
            updateUserUI();
            updateMiningDisplay();
            updateWalletUI();
            updateStakingDisplay();
            updateReferralDisplay();
        }

        function switchPage(pageName) {
            elements.navBtns.forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.page === pageName) {
                    btn.classList.add('active');
                }
            });
            
            elements.pages.forEach(page => {
                page.classList.remove('active');
                if (page.id === `${pageName}-page`) {
                    page.classList.add('active');
                }
            });
            
            switch (pageName) {
                case 'home':
                    updateMiningDisplay();
                    break;
                case 'staking':
                    updateStakingDisplay();
                    break;
                case 'wallet':
                    updateWalletUI();
                    break;
                case 'referral':
                    updateReferralDisplay();
                    break;
            }
        }

        // ============================================
        // MINING SYSTEM
        // ============================================
        function updateMiningDisplay() {
            if (!walletData.mining) return;
            
            const mining = walletData.mining;
            const level = CONFIG.MINING.LEVELS[mining.level];
            
            if (elements.currentMiningLevel) {
                elements.currentMiningLevel.textContent = mining.level;
            }
            
            if (elements.currentHashrateDisplay) {
                elements.currentHashrateDisplay.textContent = formatNumber(level.hashrate);
            }
            
            updateMiningTimer();
            
            if (elements.nextRewardAmount) {
                elements.nextRewardAmount.textContent = formatNumber(level.reward);
            }
            
            if (elements.totalMined) {
                elements.totalMined.textContent = formatNumber(mining.totalMined);
            }
            
            if (elements.minedToday) {
                const now = new Date();
                const lastMinedDate = mining.lastReward ? new Date(mining.lastReward) : null;
                if (lastMinedDate && (
                    now.getDate() !== lastMinedDate.getDate() ||
                    now.getMonth() !== lastMinedDate.getMonth() ||
                    now.getFullYear() !== lastMinedDate.getFullYear()
                )) {
                    mining.minedToday = 0;
                }
                elements.minedToday.textContent = formatNumber(mining.minedToday);
            }
            
            updateUpgradeCards();
            updateMiningButton();
        }

        function updateMiningTimer() {
            if (!walletData.mining || !elements.miningTimerDisplay) return;
            
            const now = Date.now();
            const nextRewardTime = walletData.mining.nextReward;
            
            if (!nextRewardTime) {
                elements.miningTimerDisplay.textContent = "01:00:00";
                return;
            }
            
            const timeLeft = nextRewardTime - now;
            
            if (timeLeft <= 0) {
                elements.miningTimerDisplay.textContent = "READY!";
                elements.miningTimerDisplay.style.color = "#00ff88";
                
                if (elements.startMiningBtn) {
                    elements.startMiningBtn.innerHTML = '<i class="fas fa-gift"></i><span>Claim Reward</span>';
                    elements.startMiningBtn.classList.add('claim-mode');
                }
            } else {
                const hours = Math.floor(timeLeft / (1000 * 60 * 60));
                const minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));
                const seconds = Math.floor((timeLeft % (1000 * 60)) / 1000);
                
                elements.miningTimerDisplay.textContent = 
                    `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                elements.miningTimerDisplay.style.color = "#ffffff";
                
                if (elements.startMiningBtn) {
                    elements.startMiningBtn.innerHTML = '<i class="fas fa-play"></i><span>Mining...</span>';
                    elements.startMiningBtn.classList.remove('claim-mode');
                }
            }
        }

        function updateMiningButton() {
            if (!elements.startMiningBtn) return;
            
            const mining = walletData.mining;
            const now = Date.now();
            
            if (!mining.active) {
                elements.startMiningBtn.innerHTML = '<i class="fas fa-play"></i><span>Start Mining</span>';
                elements.startMiningBtn.classList.remove('claim-mode');
            } else if (mining.nextReward && now >= mining.nextReward) {
                elements.startMiningBtn.innerHTML = '<i class="fas fa-gift"></i><span>Claim Reward</span>';
                elements.startMiningBtn.classList.add('claim-mode');
            } else {
                elements.startMiningBtn.innerHTML = '<i class="fas fa-play"></i><span>Mining...</span>';
                elements.startMiningBtn.classList.remove('claim-mode');
                elements.startMiningBtn.disabled = true;
            }
        }

        function updateUpgradeCards() {
            const upgradeCards = document.querySelectorAll('.upgrade-card');
            if (!upgradeCards || !walletData) return;
            
            const currentLevel = walletData.mining.level;
            const usdtBalance = walletData.balances.USDT || 0;
            
            upgradeCards.forEach(card => {
                const level = parseInt(card.dataset.level);
                const levelData = CONFIG.MINING.LEVELS[level];
                const button = card.querySelector('.upgrade-btn');
                
                if (!button) return;
                
                if (level === currentLevel) {
                    button.textContent = 'Active';
                    button.classList.add('active-btn');
                    button.disabled = true;
                    card.classList.add('active');
                } else if (level < currentLevel) {
                    button.textContent = 'Upgraded';
                    button.classList.add('active-btn');
                    button.disabled = true;
                    card.classList.remove('active');
                } else {
                    const canAfford = usdtBalance >= levelData.cost;
                    button.textContent = canAfford ? 'Upgrade' : `${levelData.cost} USDT`;
                    button.disabled = !canAfford;
                    button.classList.remove('active-btn');
                    card.classList.remove('active');
                }
            });
        }

        async function handleMiningAction() {
            if (!walletData.mining) return;
            
            const mining = walletData.mining;
            const now = Date.now();
            
            if (mining.active && mining.nextReward && now < mining.nextReward) {
                showMessage("â³ Mining in progress. Please wait.", "info");
                return;
            }
            
            if (!mining.active) {
                await startMining();
            } else if (mining.nextReward && now >= mining.nextReward) {
                await claimMiningReward();
            }
        }

        async function startMining() {
            try {
                walletData.mining.active = true;
                walletData.mining.lastReward = Date.now();
                walletData.mining.nextReward = Date.now() + CONFIG.MINING.DURATION;
                
                updateMiningDisplay();
                saveUserData();
                showMessage("âš¡ Quantum mining started!", "success");
                
            } catch (error) {
                console.error("âŒ Error starting mining:", error);
                showMessage("Failed to start mining", "error");
            }
        }

        async function claimMiningReward() {
            try {
                const level = CONFIG.MINING.LEVELS[walletData.mining.level];
                let reward = level.reward;
                
                walletData.mining.activeBoosters.forEach(booster => {
                    const boosterConfig = CONFIG.MINING.BOOSTERS[booster.type];
                    if (boosterConfig) {
                        reward *= boosterConfig.multiplier;
                    }
                });
                
                walletData.balances.AMSK = (walletData.balances.AMSK || 0) + reward;
                walletData.mining.totalMined = (walletData.mining.totalMined || 0) + reward;
                walletData.mining.minedToday = (walletData.mining.minedToday || 0) + reward;
                walletData.mining.lastReward = Date.now();
                walletData.mining.nextReward = Date.now() + CONFIG.MINING.DURATION;
                
                updateMiningDisplay();
                updateWalletUI();
                updateTotalBalance();
                saveUserData();
                
                showMessage(`ðŸ’° +${formatNumber(reward)} AMSK mined!`, "success");
                
            } catch (error) {
                console.error("âŒ Error claiming mining reward:", error);
                showMessage("Failed to claim reward", "error");
            }
        }

        async function upgradeMiningLevel(level) {
            try {
                level = parseInt(level);
                const levelData = CONFIG.MINING.LEVELS[level];
                
                if (!levelData) {
                    throw new Error("Invalid mining level");
                }
                
                if (level <= walletData.mining.level) {
                    showMessage("Already at or above this level!", "warning");
                    return;
                }
                
                if (walletData.balances.USDT < levelData.cost) {
                    showMessage(`Insufficient USDT. Need ${levelData.cost} USDT.`, "error");
                    return;
                }
                
                walletData.balances.USDT -= levelData.cost;
                walletData.mining.level = level;
                
                updateMiningDisplay();
                updateWalletUI();
                updateTotalBalance();
                saveUserData();
                
                showMessage(`âš¡ Upgraded to ${levelData.name} level!`, "success");
                
            } catch (error) {
                console.error("âŒ Error upgrading mining level:", error);
                showMessage("Failed to upgrade mining level", "error");
            }
        }

        // ============================================
        // WALLET SYSTEM
        // ============================================
        function updateWalletUI() {
            if (!walletData.balances) return;
            
            const { AMSK, USDT, BNB, TON } = walletData.balances;
            const { PRICES } = CONFIG;
            
            // Update individual asset displays
            const assets = [
                { symbol: 'amsk', balance: AMSK, value: AMSK * PRICES.AMSK },
                { symbol: 'usdt', balance: USDT, value: USDT * PRICES.USDT },
                { symbol: 'bnb', balance: BNB, value: BNB * PRICES.BNB },
                { symbol: 'ton', balance: TON, value: TON * PRICES.TON }
            ];
            
            assets.forEach(asset => {
                const balanceEl = document.getElementById(`wallet-${asset.symbol}-balance`);
                const valueEl = document.getElementById(`wallet-${asset.symbol}-value`);
                
                if (balanceEl) {
                    if (asset.symbol === 'amsk') {
                        balanceEl.textContent = `${formatNumber(asset.balance)} AMSK`;
                    } else if (asset.symbol === 'usdt') {
                        balanceEl.textContent = `${asset.balance.toFixed(2)} USDT`;
                    } else if (asset.symbol === 'bnb') {
                        balanceEl.textContent = `${asset.balance.toFixed(4)} BNB`;
                    } else {
                        balanceEl.textContent = `${formatNumber(asset.balance)} TON`;
                    }
                }
                
                if (valueEl) {
                    valueEl.textContent = `$${asset.value.toFixed(2)}`;
                }
            });
            
            updateTotalBalance();
        }

        function updateTotalBalance() {
            if (!walletData.balances) return;
            
            const { AMSK, USDT, BNB, TON } = walletData.balances;
            const { PRICES } = CONFIG;
            
            const totalAMSK = AMSK || 0;
            const totalUSD = (AMSK * PRICES.AMSK) + (USDT * PRICES.USDT) + (BNB * PRICES.BNB) + (TON * PRICES.TON);
            
            if (elements.totalBalanceAmsk) {
                elements.totalBalanceAmsk.textContent = formatNumber(totalAMSK);
            }
            
            if (elements.totalBalanceUsd) {
                elements.totalBalanceUsd.textContent = totalUSD.toFixed(2);
            }
            
            const walletBalanceAmsk = document.getElementById('wallet-balance-amsk');
            const walletBalanceUsd = document.getElementById('wallet-balance-usd');
            
            if (walletBalanceAmsk) {
                walletBalanceAmsk.textContent = formatNumber(totalAMSK);
            }
            
            if (walletBalanceUsd) {
                walletBalanceUsd.textContent = `$${totalUSD.toFixed(2)}`;
            }
        }

        // ============================================
        // STAKING SYSTEM
        // ============================================
        function updateStakingDisplay() {
            updateStakingStats();
            updateActiveStakes();
        }

        function updateStakingStats() {
            if (elements.totalStaked) {
                elements.totalStaked.textContent = `${walletData.staking.totalStaked} USDT`;
            }
        }

        function updateActiveStakes() {
            if (!elements.activeStakesList) return;
            
            const activeStakes = walletData.staking.activeStakes || [];
            
            if (!activeStakes.length) {
                elements.activeStakesList.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-inbox"></i>
                        <p>No active stakes yet</p>
                        <small>Start staking to earn rewards</small>
                    </div>
                `;
                return;
            }
            
            let html = '';
            activeStakes.forEach((stake, index) => {
                const plan = CONFIG.STAKING.PLANS[stake.planId];
                if (!plan) return;
                
                const now = Date.now();
                const startTime = stake.startTime || now;
                const durationMs = plan.duration * 24 * 60 * 60 * 1000;
                const endTime = startTime + durationMs;
                const progress = Math.min(((now - startTime) / durationMs) * 100, 100);
                const daysLeft = Math.ceil((endTime - now) / (24 * 60 * 60 * 1000));
                
                const dailyReward = Math.floor((stake.amount / 100) * plan.dailyPer100);
                const totalReward = dailyReward * plan.duration;
                
                html += `
                    <div class="stake-item" style="background: linear-gradient(145deg, rgba(26,26,58,0.8), rgba(42,26,74,0.8)); border-radius: var(--radius-md); padding: var(--space-md); margin-bottom: var(--space-sm); border: var(--border-space);">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--space-sm);">
                            <div style="font-weight: 700; color: var(--star-white);">${plan.name} - ${stake.amount} USDT</div>
                            <span style="background: rgba(0,255,157,0.1); color: var(--neon-green); padding: 4px 8px; border-radius: var(--radius-sm); font-size: 12px;">Active</span>
                        </div>
                        <div style="margin-bottom: var(--space-sm);">
                            <div style="display: flex; justify-content: space-between; font-size: 12px; color: var(--star-light); margin-bottom: 4px;">
                                <span>${Math.round(progress)}%</span>
                                <span>${daysLeft} days left</span>
                            </div>
                            <div style="height: 4px; background: rgba(255,255,255,0.1); border-radius: 2px; overflow: hidden;">
                                <div style="width: ${progress}%; height: 100%; background: var(--gradient-neon);"></div>
                            </div>
                        </div>
                        <div style="display: flex; justify-content: space-between; font-size: 12px; color: var(--star-light);">
                            <div>${plan.apr}% APR</div>
                            <div>${dailyReward.toLocaleString()} AMSK/Day</div>
                            <div>Total: ${totalReward.toLocaleString()} AMSK</div>
                        </div>
                    </div>
                `;
            });
            
            elements.activeStakesList.innerHTML = html;
        }

        // ============================================
        // REFERRAL SYSTEM
        // ============================================
        async function checkForReferral() {
            console.log("ðŸ” Checking for referral...");
            
            let referralCode = null;
            if (tg && tg.initDataUnsafe && tg.initDataUnsafe.start_param) {
                referralCode = tg.initDataUnsafe.start_param;
                console.log("ðŸ“± Telegram referral detected:", referralCode);
            }
            
            if (!referralCode) {
                const urlParams = new URLSearchParams(window.location.search);
                referralCode = urlParams.get('startapp') || urlParams.get('ref') || urlParams.get('start');
            }
            
            if (referralCode && referralCode !== userData.referralCode) {
                console.log("ðŸŽ¯ Processing referral:", referralCode);
                await processReferral(referralCode);
            }
        }

        async function processReferral(referralCode) {
            if (!referralCode || referralCode === userData.referralCode) {
                console.log("âš ï¸ Invalid or self-referral");
                return;
            }
            
            if (userData.referredBy) {
                console.log("âš ï¸ User already referred by:", userData.referredBy);
                return;
            }
            
            try {
                userData.referredBy = referralCode;
                walletData.balances.AMSK += CONFIG.REFERRAL.WELCOME_BONUS;
                walletData.mining.totalMined += CONFIG.REFERRAL.WELCOME_BONUS;
                
                saveUserData();
                
                if (db) {
                    await updateReferrerRewards(referralCode);
                }
                
                updateWalletUI();
                updateMiningDisplay();
                updateReferralDisplay();
                
                showMessage(`ðŸŽ‰ Welcome bonus received! +${CONFIG.REFERRAL.WELCOME_BONUS.toLocaleString()} AMSK`, "success");
                
                console.log("âœ… Referral processed successfully");
                
            } catch (error) {
                console.error("âŒ Referral processing error:", error);
            }
        }

        function updateReferralDisplay() {
            if (!walletData.referrals) return;
            
            const referrals = walletData.referrals;
            
            if (elements.refCount) {
                elements.refCount.textContent = referrals.count;
            }
            
            if (elements.refEarned) {
                elements.refEarned.textContent = formatNumber(referrals.earned);
            }
            
            if (elements.referralCodeDisplay) {
                elements.referralCodeDisplay.textContent = userData.referralCode;
            }
            
            if (elements.referralLinkInput) {
                elements.referralLinkInput.value = `https://t.me/AlienMuskbot/Musk?startapp=${userData.referralCode}`;
            }
            
            updateMilestonesDisplay();
        }

        function updateMilestonesDisplay() {
            const milestoneItems = document.querySelectorAll('.milestone-item');
            if (!milestoneItems || milestoneItems.length === 0) return;
            
            const referralCount = walletData.referrals?.count || 0;
            const claimedMilestones = walletData.referrals?.claimedMilestones || [];
            
            milestoneItems.forEach(item => {
                const requirement = item.querySelector('.milestone-requirement')?.textContent;
                if (!requirement) return;
                
                const milestoneMatch = requirement.match(/\d+/);
                if (!milestoneMatch) return;
                
                const milestoneNum = parseInt(milestoneMatch[0]);
                const badge = item.querySelector('.milestone-action');
                
                item.classList.remove('locked', 'can-claim', 'claimed');
                
                if (claimedMilestones.includes(milestoneNum)) {
                    item.classList.add('claimed');
                    if (badge) {
                        badge.innerHTML = '<span class="claimed-badge">Claimed</span>';
                    }
                } else if (referralCount >= milestoneNum) {
                    item.classList.add('can-claim');
                    if (badge) {
                        badge.innerHTML = `<button class="btn-claim-milestone" onclick="claimMilestone(${milestoneNum})">Claim</button>`;
                    }
                } else {
                    item.classList.add('locked');
                    if (badge) {
                        badge.innerHTML = `<span class="locked-badge">${referralCount}/${milestoneNum}</span>`;
                    }
                }
            });
        }

        // ============================================
        // EVENT LISTENERS
        // ============================================
        function setupEventListeners() {
            console.log("ðŸŽ¯ Setting up event listeners...");
            
            // Navigation buttons
            elements.navBtns.forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.preventDefault();
                    const page = btn.dataset.page;
                    switchPage(page);
                });
            });
            
            // Mining button
            if (elements.startMiningBtn) {
                elements.startMiningBtn.addEventListener('click', handleMiningAction);
            }
            
            // Admin logo
            if (elements.adminLogo) {
                elements.adminLogo.addEventListener('click', handleAdminLogoClick);
            }
            
            // Wallet action buttons
            if (elements.depositBtn) {
                elements.depositBtn.addEventListener('click', () => {
                    showMessage("Deposit feature coming soon!", "info");
                });
            }
            
            if (elements.withdrawBtn) {
                elements.withdrawBtn.addEventListener('click', () => {
                    showMessage("Withdraw feature coming soon!", "info");
                });
            }
            
            if (elements.swapBtn) {
                elements.swapBtn.addEventListener('click', () => {
                    showMessage("Swap feature coming soon!", "info");
                });
            }
            
            if (elements.historyBtn) {
                elements.historyBtn.addEventListener('click', () => {
                    showMessage("History feature coming soon!", "info");
                });
            }
            
            console.log("âœ… Event listeners setup complete");
        }

        // ============================================
        // ADMIN SYSTEM
        // ============================================
        function initAdminSystem() {
            if (elements.adminLogo) {
                console.log("ðŸ’Ž Admin system initialized");
            }
        }

        function handleAdminLogoClick() {
            const now = Date.now();
            
            if (now - lastGemClickTime > 2000) {
                gemClickCount = 0;
            }
            
            gemClickCount++;
            lastGemClickTime = now;
            
            console.log(`ðŸ’Ž Logo click ${gemClickCount}/5`);
            
            if (gemClickCount >= 5) {
                showAdminLogin();
                gemClickCount = 0;
            }
        }

        // ============================================
        // UTILITY FUNCTIONS
        // ============================================
        function formatNumber(num, decimals = 0) {
            if (typeof num !== 'number' || isNaN(num)) return '0';
            
            if (num >= 1000000) {
                return (num / 1000000).toFixed(decimals) + 'M';
            } else if (num >= 1000) {
                return (num / 1000).toFixed(decimals) + 'K';
            }
            
            return num.toLocaleString('en-US', {
                minimumFractionDigits: decimals,
                maximumFractionDigits: decimals
            });
        }

        function saveUserData() {
            if (!userData.id) {
                console.error("âŒ Cannot save: No user ID");
                return;
            }
            
            try {
                userData.lastActive = new Date().toISOString();
                walletData.lastUpdate = Date.now();
                
                const storageKey = `alien_musk_${userData.id}`;
                const dataToSave = {
                    balances: walletData.balances,
                    mining: walletData.mining,
                    staking: walletData.staking,
                    referrals: walletData.referrals,
                    pendingDeposits: walletData.pendingDeposits,
                    pendingWithdrawals: walletData.pendingWithdrawals,
                    depositHistory: walletData.depositHistory,
                    withdrawalHistory: walletData.withdrawalHistory,
                    usedTransactions: walletData.usedTransactions,
                    lastUpdate: walletData.lastUpdate
                };
                
                localStorage.setItem(storageKey, JSON.stringify(dataToSave));
                console.log("ðŸ’¾ User data saved to localStorage");
                
                userData.lastSaveTime = Date.now();
                
            } catch (error) {
                console.error("âŒ Save error:", error);
            }
        }

        function showMessage(text, type = 'info') {
            const container = document.getElementById('notification-container');
            if (!container) return;
            
            const message = document.createElement('div');
            message.className = `message ${type}`;
            
            let icon = 'fa-info-circle';
            switch (type) {
                case 'success': icon = 'fa-check-circle'; break;
                case 'error': icon = 'fa-exclamation-circle'; break;
                case 'warning': icon = 'fa-exclamation-triangle'; break;
            }
            
            message.innerHTML = `
                <i class="fas ${icon}"></i>
                <span>${text}</span>
            `;
            
            container.appendChild(message);
            
            setTimeout(() => {
                if (message.parentNode) {
                    message.style.opacity = '0';
                    message.style.transform = 'translateX(-50%) translateY(-10px)';
                    setTimeout(() => {
                        if (message.parentNode) {
                            message.parentNode.removeChild(message);
                        }
                    }, 300);
                }
            }, 4000);
            
            console.log(`${type}: ${text}`);
        }

        // ============================================
        // BACKGROUND SERVICES
        // ============================================
        function startBackgroundServices() {
            intervals.miningTimer = setInterval(() => {
                updateMiningTimer();
            }, 1000);
            
            intervals.autoSave = setInterval(() => {
                if (userData.id && userData.isInitialized) {
                    saveUserData();
                }
            }, 30000);
            
            intervals.updateTimer = setInterval(() => {
                if (userData) {
                    userData.lastActive = new Date().toISOString();
                }
            }, 60000);
            
            console.log("â±ï¸ Background services started");
        }

        // ============================================
        // GLOBAL EXPORTS
        // ============================================
        window.initAlienMuskApp = initAlienMuskApp;
        window.handleMiningAction = handleMiningAction;
        window.upgradeMiningLevel = upgradeMiningLevel;
        window.openStakeModal = openStakeModal;
        window.switchPage = switchPage;
        window.copyReferralCode = copyReferralCode;
        window.copyReferralLink = copyReferralLink;
        window.shareOnTelegram = shareOnTelegram;
        window.shareOnWhatsApp = shareOnWhatsApp;
        window.showMessage = showMessage;

        // ============================================
        // REFERRAL FUNCTIONS
        // ============================================
        window.copyReferralCode = function() {
            const codeElement = document.getElementById('referral-code-display');
            if (codeElement) {
                navigator.clipboard.writeText(codeElement.textContent)
                    .then(() => showMessage('âœ… Referral code copied!', 'success'))
                    .catch(() => showMessage('âŒ Failed to copy code', 'error'));
            }
        };

        window.copyReferralLink = function() {
            const linkInput = document.getElementById('referral-link-input');
            if (linkInput) {
                navigator.clipboard.writeText(linkInput.value)
                    .then(() => showMessage('âœ… Referral link copied!', 'success'))
                    .catch(() => showMessage('âŒ Failed to copy link', 'error'));
            }
        };

        window.shareOnTelegram = function() {
            const linkInput = document.getElementById('referral-link-input');
            if (!linkInput) return;
            
            const link = linkInput.value;
            const text = `ðŸš€ Join Alien Musk Quantum Mining Platform!\n\nâ›ï¸ *Mine AMSK tokens every hour*\nðŸ’° *Earn from staking and referrals*\nðŸ‘¥ *Get 10,000 AMSK bonus with my link*\n\nðŸ‘‰ ${link}\n\nðŸ’Ž *Start your quantum mining journey!*`;
            const url = `https://t.me/share/url?url=${encodeURIComponent(link)}&text=${encodeURIComponent(text)}`;
            
            window.open(url, '_blank');
        };

        window.shareOnWhatsApp = function() {
            const linkInput = document.getElementById('referral-link-input');
            if (!linkInput) return;
            
            const link = linkInput.value;
            const text = `ðŸš€ Join Alien Musk Quantum Mining Platform!\n\nMine AMSK tokens every hour\nEarn from staking and referrals\nGet 10,000 AMSK bonus with my link\n\n${link}`;
            const url = `https://wa.me/?text=${encodeURIComponent(text)}`;
            
            window.open(url, '_blank');
        };

        // Initialize the app
        console.log("ðŸ‘½ Alien Musk Quantum Platform v6.0 - Professional Edition Ready!");
        
        // Start the app when DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initAlienMuskApp);
        } else {
            initAlienMuskApp();
        }
    </script>
</body>
</html>
